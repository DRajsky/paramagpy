
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>paramagpy.gui &#8212; paramagpy 0.1 documentation</title>
    <link rel="stylesheet" href="../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">paramagpy 0.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" accesskey="U">Module code</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for paramagpy.gui</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/home/u5376227/.virtualenvs/venvpylanth/bin/python</span>
<span class="kn">import</span> <span class="nn">tkinter</span> <span class="k">as</span> <span class="nn">tk</span>
<span class="kn">from</span> <span class="nn">tkinter</span> <span class="k">import</span> <span class="n">filedialog</span><span class="p">,</span> <span class="n">messagebox</span><span class="p">,</span> <span class="n">ttk</span><span class="p">,</span> <span class="n">font</span>
<span class="kn">from</span> <span class="nn">tkinter.colorchooser</span> <span class="k">import</span> <span class="n">askcolor</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">sys</span><span class="o">,</span> <span class="nn">subprocess</span><span class="o">,</span> <span class="nn">shutil</span>
<span class="kn">from</span> <span class="nn">pprint</span> <span class="k">import</span> <span class="n">pprint</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="k">import</span> <span class="n">OrderedDict</span>

<span class="kn">from</span> <span class="nn">paramagpy</span> <span class="k">import</span> <span class="n">metal</span><span class="p">,</span> <span class="n">fit</span><span class="p">,</span> <span class="n">protein</span><span class="p">,</span> <span class="n">dataparse</span>

<span class="k">def</span> <span class="nf">platform_settings</span><span class="p">():</span>
	<span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span> <span class="o">==</span> <span class="s1">&#39;darwin&#39;</span><span class="p">:</span>
		<span class="n">settings</span> <span class="o">=</span> <span class="p">{</span>
			<span class="s1">&#39;listboxFontSize&#39;</span><span class="p">:</span> <span class="mi">14</span>
		<span class="p">}</span>
	<span class="k">elif</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span> <span class="o">==</span> <span class="s1">&#39;linux&#39;</span><span class="p">:</span>
		<span class="n">settings</span> <span class="o">=</span> <span class="p">{</span>
			<span class="s1">&#39;listboxFontSize&#39;</span><span class="p">:</span> <span class="mi">10</span>
		<span class="p">}</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="n">settings</span> <span class="o">=</span> <span class="p">{}</span>
	<span class="k">return</span> <span class="n">settings</span>


<span class="k">def</span> <span class="nf">format_path</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">length</span><span class="p">):</span>
	<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">length</span><span class="p">:</span>
		<span class="n">fmt</span> <span class="o">=</span> <span class="s2">&quot;...{{:&lt;</span><span class="si">{}</span><span class="s2">}}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">length</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">path</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="o">-</span><span class="n">length</span><span class="o">+</span><span class="mi">3</span><span class="p">:])</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="n">fmt</span> <span class="o">=</span> <span class="s2">&quot;{{:&lt;</span><span class="si">{}</span><span class="s2">}}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">length</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">unpack_ranges</span><span class="p">(</span><span class="n">string</span><span class="p">):</span>
	<span class="n">out</span> <span class="o">=</span> <span class="p">[]</span>
	<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">string</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">):</span>
		<span class="k">if</span> <span class="s1">&#39;-&#39;</span> <span class="ow">in</span> <span class="n">i</span><span class="p">:</span>
			<span class="n">j</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">i</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">))</span>
			<span class="k">if</span> <span class="n">j</span><span class="o">&gt;=</span><span class="n">k</span><span class="p">:</span>
				<span class="k">raise</span> <span class="ne">ValueError</span>
			<span class="n">out</span> <span class="o">+=</span> <span class="nb">range</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">out</span> <span class="o">+=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span>
	<span class="k">return</span> <span class="nb">set</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">Tooltip</span><span class="p">:</span>
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">widget</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;#FFFFEA&#39;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
		<span class="n">waittime</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">wraplength</span><span class="o">=</span><span class="mi">250</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">waittime</span> <span class="o">=</span> <span class="n">waittime</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">wraplength</span> <span class="o">=</span> <span class="n">wraplength</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">widget</span> <span class="o">=</span> <span class="n">widget</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">text</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Enter&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">onEnter</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Leave&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">onLeave</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;ButtonPress&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">onLeave</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">bg</span> <span class="o">=</span> <span class="n">bg</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">pad</span> <span class="o">=</span> <span class="n">pad</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="kc">None</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">tw</span> <span class="o">=</span> <span class="kc">None</span>

	<span class="k">def</span> <span class="nf">onEnter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">schedule</span><span class="p">()</span>

	<span class="k">def</span> <span class="nf">onLeave</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">unschedule</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">hide</span><span class="p">()</span>

	<span class="k">def</span> <span class="nf">schedule</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">unschedule</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">after</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">waittime</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">show</span><span class="p">)</span>

	<span class="k">def</span> <span class="nf">unschedule</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="n">id_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">id</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="kc">None</span>
		<span class="k">if</span> <span class="n">id_</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">after_cancel</span><span class="p">(</span><span class="n">id_</span><span class="p">)</span>

	<span class="k">def</span> <span class="nf">show</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">def</span> <span class="nf">tip_pos_calculator</span><span class="p">(</span><span class="n">widget</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span>
			<span class="n">tip_delta</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">pad</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">)):</span>
			<span class="n">w</span> <span class="o">=</span> <span class="n">widget</span>
			<span class="n">s_width</span><span class="p">,</span> <span class="n">s_height</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">winfo_screenwidth</span><span class="p">(),</span> <span class="n">w</span><span class="o">.</span><span class="n">winfo_screenheight</span><span class="p">()</span>
			<span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="p">(</span><span class="n">pad</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">label</span><span class="o">.</span><span class="n">winfo_reqwidth</span><span class="p">()</span> <span class="o">+</span> <span class="n">pad</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
							 <span class="n">pad</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">label</span><span class="o">.</span><span class="n">winfo_reqheight</span><span class="p">()</span> <span class="o">+</span> <span class="n">pad</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
			<span class="n">mouse_x</span><span class="p">,</span> <span class="n">mouse_y</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">winfo_pointerxy</span><span class="p">()</span>
			<span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">mouse_x</span> <span class="o">+</span> <span class="n">tip_delta</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">mouse_y</span> <span class="o">+</span> <span class="n">tip_delta</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
			<span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">x1</span> <span class="o">+</span> <span class="n">width</span><span class="p">,</span> <span class="n">y1</span> <span class="o">+</span> <span class="n">height</span>
			<span class="n">x_delta</span> <span class="o">=</span> <span class="n">x2</span> <span class="o">-</span> <span class="n">s_width</span>
			<span class="k">if</span> <span class="n">x_delta</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
				<span class="n">x_delta</span> <span class="o">=</span> <span class="mi">0</span>
			<span class="n">y_delta</span> <span class="o">=</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">s_height</span>
			<span class="k">if</span> <span class="n">y_delta</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
				<span class="n">y_delta</span> <span class="o">=</span> <span class="mi">0</span>
			<span class="n">offscreen</span> <span class="o">=</span> <span class="p">(</span><span class="n">x_delta</span><span class="p">,</span> <span class="n">y_delta</span><span class="p">)</span> <span class="o">!=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
			<span class="k">if</span> <span class="n">offscreen</span><span class="p">:</span>
				<span class="k">if</span> <span class="n">x_delta</span><span class="p">:</span>
					<span class="n">x1</span> <span class="o">=</span> <span class="n">mouse_x</span> <span class="o">-</span> <span class="n">tip_delta</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">width</span>

				<span class="k">if</span> <span class="n">y_delta</span><span class="p">:</span>
					<span class="n">y1</span> <span class="o">=</span> <span class="n">mouse_y</span> <span class="o">-</span> <span class="n">tip_delta</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">height</span>
			<span class="n">offscreen_again</span> <span class="o">=</span> <span class="n">y1</span> <span class="o">&lt;</span> <span class="mi">0</span>
			<span class="k">if</span> <span class="n">offscreen_again</span><span class="p">:</span>
				<span class="n">y1</span> <span class="o">=</span> <span class="mi">0</span>
			<span class="k">return</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span>

		<span class="n">bg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bg</span>
		<span class="n">pad</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pad</span>
		<span class="n">widget</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget</span>

		<span class="bp">self</span><span class="o">.</span><span class="n">tw</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Toplevel</span><span class="p">(</span><span class="n">widget</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">tw</span><span class="o">.</span><span class="n">wm_overrideredirect</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
		<span class="n">win</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tw</span><span class="p">,</span>
					   <span class="n">background</span><span class="o">=</span><span class="n">bg</span><span class="p">,</span>
					   <span class="n">borderwidth</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
		<span class="n">label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">win</span><span class="p">,</span>
						  <span class="n">text</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">,</span>
						  <span class="n">justify</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">LEFT</span><span class="p">,</span>
						  <span class="n">background</span><span class="o">=</span><span class="n">bg</span><span class="p">,</span>
						  <span class="n">relief</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">SOLID</span><span class="p">,</span>
						  <span class="n">borderwidth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
						  <span class="n">wraplength</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">wraplength</span><span class="p">)</span>
		<span class="n">label</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">padx</span><span class="o">=</span><span class="p">(</span><span class="n">pad</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pad</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span>
				   <span class="n">pady</span><span class="o">=</span><span class="p">(</span><span class="n">pad</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">pad</span><span class="p">[</span><span class="mi">3</span><span class="p">]),</span>
				   <span class="n">sticky</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">NSEW</span><span class="p">)</span>
		<span class="n">win</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
		<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">tip_pos_calculator</span><span class="p">(</span><span class="n">widget</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">tw</span><span class="o">.</span><span class="n">wm_geometry</span><span class="p">(</span><span class="s2">&quot;+</span><span class="si">%d</span><span class="s2">+</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>

	<span class="k">def</span> <span class="nf">hide</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="n">tw</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tw</span>
		<span class="k">if</span> <span class="n">tw</span><span class="p">:</span>
			<span class="n">tw</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">tw</span> <span class="o">=</span> <span class="kc">None</span>


<div class="viewcode-block" id="CustomTextDefaultEntry"><a class="viewcode-back" href="../../index.html#paramagpy.gui.CustomTextDefaultEntry">[docs]</a><span class="k">class</span> <span class="nc">CustomTextDefaultEntry</span><span class="p">(</span><span class="n">tk</span><span class="o">.</span><span class="n">Entry</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;Entry widget that has greyed out default text&quot;&quot;&quot;</span>
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">default_text</span><span class="p">,</span> 
		<span class="n">returnKey</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;models&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">25</span><span class="p">):</span>
		<span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">default_text</span> <span class="o">=</span> <span class="n">default_text</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">mode</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">default_text</span><span class="p">)</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="o">==</span><span class="s1">&#39;models&#39;</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">defaultColour</span> <span class="o">=</span> <span class="s1">&#39;grey&#39;</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">fg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">defaultColour</span><span class="p">)</span>
		<span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="o">==</span><span class="s1">&#39;files&#39;</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">defaultColour</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">fg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">defaultColour</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s1">&#39;&lt;FocusIn&gt;&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_entry_click</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s1">&#39;&lt;FocusOut&gt;&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_focusout</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">returnKey</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s1">&#39;&lt;Return&gt;&#39;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">returnKey</span><span class="p">())</span>

	<span class="k">def</span> <span class="nf">on_entry_click</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
		<span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="o">==</span><span class="s1">&#39;models&#39;</span><span class="p">:</span>
			<span class="k">if</span> <span class="n">s</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_text</span><span class="p">:</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">fg</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">)</span>
		<span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="o">==</span><span class="s1">&#39;files&#39;</span><span class="p">:</span>
			<span class="n">f</span><span class="p">,</span> <span class="n">e</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">icursor</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">f</span><span class="p">))</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">select_range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">f</span><span class="p">))</span>

	<span class="k">def</span> <span class="nf">on_focusout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_text</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">fg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">defaultColour</span><span class="p">)</span>

	<span class="k">def</span> <span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;end&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="NumericEntry"><a class="viewcode-back" href="../../index.html#paramagpy.gui.NumericEntry">[docs]</a><span class="k">class</span> <span class="nc">NumericEntry</span><span class="p">(</span><span class="n">tk</span><span class="o">.</span><span class="n">Entry</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;Includes float validation and variable storing in tk.StringVar&quot;&quot;&quot;</span>
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">root</span><span class="p">,</span> <span class="n">parse</span><span class="p">,</span> <span class="n">display</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="s1">&#39;normal&#39;</span><span class="p">,</span> 
		<span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">formatter</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">{:.3f}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">onlyPositive</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">):</span>

		<span class="bp">self</span><span class="o">.</span><span class="n">dtype</span> <span class="o">=</span> <span class="n">dtype</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">label</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">formatter</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">formatter</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">textVar</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">floatVar</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">DoubleVar</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">onlyPositive</span> <span class="o">=</span> <span class="n">onlyPositive</span>

		<span class="k">if</span> <span class="n">callable</span><span class="p">(</span><span class="n">parse</span><span class="p">):</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">parser</span> <span class="o">=</span> <span class="n">parse</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">display</span> <span class="o">=</span> <span class="n">display</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">dummy_store</span><span class="p">(</span><span class="n">display</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">parser</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">dummy_store</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">display</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dummy_get</span>

		<span class="n">vcmd</span> <span class="o">=</span> <span class="p">(</span><span class="n">root</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">validate</span><span class="p">),</span><span class="s1">&#39;%P&#39;</span><span class="p">)</span>
		<span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">textVar</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="s1">&#39;key&#39;</span><span class="p">,</span> 
			<span class="n">validatecommand</span><span class="o">=</span><span class="n">vcmd</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="n">state</span><span class="p">)</span>
		
		<span class="bp">self</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s1">&#39;&lt;FocusIn&gt;&#39;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">highlight</span><span class="p">())</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s1">&#39;&lt;FocusOut&gt;&#39;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">())</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s1">&#39;&lt;Return&gt;&#39;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">highlight</span><span class="p">()])</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s1">&#39;&lt;KP_Enter&gt;&#39;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">highlight</span><span class="p">()])</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>

<div class="viewcode-block" id="NumericEntry.update"><a class="viewcode-back" href="../../index.html#paramagpy.gui.NumericEntry.update">[docs]</a>	<span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="n">var</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">formatter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="p">())</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">textVar</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">var</span><span class="p">)</span></div>

	<span class="k">def</span> <span class="nf">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value_if_allowed</span><span class="p">):</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">onlyPositive</span><span class="p">:</span>
			<span class="n">initchars</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;+&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="o">==</span><span class="nb">float</span><span class="p">:</span>
				<span class="n">initchars</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="s1">&#39;+.&#39;</span><span class="p">]</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">initchars</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;+&#39;</span><span class="p">,</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="o">==</span><span class="nb">float</span><span class="p">:</span>
				<span class="n">initchars</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="s1">&#39;+.&#39;</span><span class="p">,</span><span class="s1">&#39;-.&#39;</span><span class="p">]</span>

		<span class="k">if</span> <span class="n">value_if_allowed</span> <span class="ow">in</span> <span class="n">initchars</span><span class="p">:</span>
			<span class="k">return</span> <span class="kc">True</span>
		
		<span class="k">try</span><span class="p">:</span>
			<span class="n">val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span><span class="n">value_if_allowed</span><span class="p">)</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">onlyPositive</span> <span class="ow">and</span> <span class="n">val</span><span class="o">&lt;</span><span class="mf">0.0</span><span class="p">:</span>
				<span class="k">raise</span> <span class="ne">ValueError</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
			<span class="k">return</span> <span class="kc">True</span>
		<span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
			<span class="k">return</span> <span class="kc">False</span>

		<span class="k">return</span> <span class="kc">False</span>

	<span class="k">def</span> <span class="nf">dummy_store</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">floatVar</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>

	<span class="k">def</span> <span class="nf">dummy_get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">floatVar</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>

	<span class="k">def</span> <span class="nf">highlight</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">icursor</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">()))</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">select_range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;end&#39;</span><span class="p">)</span>

	<span class="k">def</span> <span class="nf">enable</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="s1">&#39;normal&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">fg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>

	<span class="k">def</span> <span class="nf">disable</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="s1">&#39;disabled&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">fg</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="Popup"><a class="viewcode-back" href="../../index.html#paramagpy.gui.Popup">[docs]</a><span class="k">class</span> <span class="nc">Popup</span><span class="p">(</span><span class="n">tk</span><span class="o">.</span><span class="n">Toplevel</span><span class="p">):</span>
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
		<span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span>
		<span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">winfo_rootx</span><span class="p">()</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">winfo_width</span><span class="p">()</span><span class="o">//</span><span class="mi">2</span>
		<span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">winfo_rooty</span><span class="p">()</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">winfo_height</span><span class="p">()</span><span class="o">//</span><span class="mi">2</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">geometry</span><span class="p">(</span><span class="s2">&quot;+</span><span class="si">{0:d}</span><span class="s2">+</span><span class="si">{1:d}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">))</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">transient</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">protocol</span><span class="p">(</span><span class="s2">&quot;WM_DELETE_WINDOW&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">death</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">grab_set</span><span class="p">()</span>

	<span class="k">def</span> <span class="nf">last_words</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
		<span class="k">pass</span>

	<span class="k">def</span> <span class="nf">death</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">last_words</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">focus_set</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span></div>


<div class="viewcode-block" id="ProgressPopup"><a class="viewcode-back" href="../../index.html#paramagpy.gui.ProgressPopup">[docs]</a><span class="k">class</span> <span class="nc">ProgressPopup</span><span class="p">(</span><span class="n">Popup</span><span class="p">):</span>
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">variable</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">num_iter</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
		<span class="n">mode</span><span class="o">=</span><span class="s1">&#39;determinate&#39;</span><span class="p">,</span> <span class="n">auto_close</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Fitting progress&quot;</span><span class="p">):</span>
		<span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">auto_close</span> <span class="o">=</span> <span class="n">auto_close</span>
		<span class="k">if</span> <span class="n">num_iter</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">points</span> <span class="o">=</span> <span class="n">num_iter</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">points</span> <span class="o">=</span> <span class="mi">50</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">last</span> <span class="o">=</span> <span class="mf">0.0</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">incr</span> <span class="o">=</span> <span class="mf">1.0</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">points</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">var</span> <span class="o">=</span> <span class="n">variable</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">traceID</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">var</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">change</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">text</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">pack</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">prog</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Progressbar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">maximum</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="p">,</span> 
			<span class="n">length</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">prog</span><span class="o">.</span><span class="n">pack</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>

	<span class="k">def</span> <span class="nf">change</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
		<span class="n">val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">var</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
		<span class="k">if</span> <span class="n">val</span> <span class="o">&gt;=</span> <span class="mf">1.0</span><span class="p">:</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">auto_close</span><span class="p">:</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">death</span><span class="p">()</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
		<span class="k">elif</span> <span class="nb">abs</span><span class="p">(</span><span class="n">val</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">last</span><span class="p">)</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">incr</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">last</span> <span class="o">=</span> <span class="n">val</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">prog</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">val</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">prog</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>

	<span class="k">def</span> <span class="nf">set_label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">newtext</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">newtext</span><span class="p">)</span>

	<span class="k">def</span> <span class="nf">last_words</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">var</span><span class="o">.</span><span class="n">trace_vdelete</span><span class="p">(</span><span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">traceID</span><span class="p">)</span></div>


<div class="viewcode-block" id="PlotTensorPopup"><a class="viewcode-back" href="../../index.html#paramagpy.gui.PlotTensorPopup">[docs]</a><span class="k">class</span> <span class="nc">PlotTensorPopup</span><span class="p">(</span><span class="n">Popup</span><span class="p">):</span>
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">):</span>
		<span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="s2">&quot;Plot tensor isosurface&quot;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">pathWidth</span> <span class="o">=</span> <span class="mi">40</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>

		<span class="bp">self</span><span class="o">.</span><span class="n">curdir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">loadData</span><span class="o">.</span><span class="n">currentDir</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">default_fileName</span> <span class="o">=</span> <span class="s2">&quot;isosurface&quot;</span>

		<span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Location:&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;E&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">lbl_dir</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> 
			<span class="n">text</span><span class="o">=</span><span class="n">format_path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">curdir</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pathWidth</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">lbl_dir</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
		<span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;...&quot;</span><span class="p">,</span> 
			<span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">change_dir</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

		<span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Save Directory Name:&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span>
			<span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;E&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">saveName</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s1">&#39;isosurface&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">saveName</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="s1">&#39;w&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">saveNameChange</span><span class="p">)</span>
		<span class="n">ttk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">saveName</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span>
			<span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;ew&#39;</span><span class="p">)</span>

		<span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;PyMol Script File:&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span>
			<span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;E&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">pymol_file_label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">pymol_file_label</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;W&#39;</span><span class="p">)</span>

		<span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Mesh File:&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;E&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">mesh_file_label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">mesh_file_label</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;W&#39;</span><span class="p">)</span>

		<span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Points per </span><span class="se">\u00c5</span><span class="s2">:&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span>
			<span class="n">row</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;E&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">dens_input</span> <span class="o">=</span> <span class="n">NumericEntry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">formatter</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">{:d}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">onlyPositive</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">dens_input</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;W&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;dens&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dens_input</span><span class="o">.</span><span class="n">floatVar</span>

		<span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Grid size </span><span class="se">\u00c5</span><span class="s2">:&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span>
			<span class="n">row</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;E&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">size_input</span> <span class="o">=</span> <span class="n">NumericEntry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mf">40.0</span><span class="p">,</span> <span class="n">formatter</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">{:.1f}</span><span class="s2">&quot;</span><span class="p">,</span>
			<span class="n">onlyPositive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">size_input</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;W&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">size_input</span><span class="o">.</span><span class="n">floatVar</span>

		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">frm_pdb</span><span class="o">.</span><span class="n">prot</span><span class="p">:</span>
			<span class="n">state</span> <span class="o">=</span> <span class="s1">&#39;normal&#39;</span>
			<span class="n">value</span> <span class="o">=</span> <span class="mi">1</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">state</span> <span class="o">=</span> <span class="s1">&#39;disabled&#39;</span>
			<span class="n">value</span> <span class="o">=</span> <span class="mi">0</span>

		<span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Include PDB structure:&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span>
			<span class="n">row</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;E&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;pdb&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">IntVar</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="n">value</span><span class="p">)</span>
		<span class="n">chk</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Checkbutton</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">variable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;pdb&#39;</span><span class="p">],</span> 
			<span class="n">state</span><span class="o">=</span><span class="n">state</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;W&#39;</span><span class="p">)</span>

		<span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Contour Level&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span>
			<span class="n">row</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;E&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">cont_input</span> <span class="o">=</span> <span class="n">NumericEntry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">formatter</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="p">,</span>
			<span class="n">onlyPositive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">cont_input</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;W&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;cont&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cont_input</span><span class="o">.</span><span class="n">floatVar</span>

		<span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Save&#39;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">save</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
		<span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Save + Pymol&#39;</span><span class="p">,</span> 
			<span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">save_and_call_pymol</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

		<span class="bp">self</span><span class="o">.</span><span class="n">saveNameChange</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>

	<span class="k">def</span> <span class="nf">change_dir</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="n">d</span> <span class="o">=</span> <span class="n">filedialog</span><span class="o">.</span><span class="n">askdirectory</span><span class="p">(</span><span class="n">initialdir</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">curdir</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">d</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">curdir</span> <span class="o">=</span> <span class="n">d</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">lbl_dir</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">format_path</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pathWidth</span><span class="p">))</span>

	<span class="k">def</span> <span class="nf">saveNameChange</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
		<span class="n">pymolLabel</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">saveName</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_pymol_file</span><span class="p">())</span>
		<span class="n">meshLabel</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">saveName</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_mesh_file</span><span class="p">())</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">pymol_file_label</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">pymolLabel</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">mesh_file_label</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">meshLabel</span><span class="p">)</span>

	<span class="k">def</span> <span class="nf">get_pymol_file</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">return</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">.pml&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">saveName</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>

	<span class="k">def</span> <span class="nf">get_mesh_file</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">return</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">.pml.ccp4&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">saveName</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>

	<span class="k">def</span> <span class="nf">get_pymol_file_path</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">curdir</span><span class="p">,</span> 
			<span class="bp">self</span><span class="o">.</span><span class="n">saveName</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_pymol_file</span><span class="p">())</span>

	<span class="k">def</span> <span class="nf">get_mesh_file_path</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">curdir</span><span class="p">,</span> 
			<span class="bp">self</span><span class="o">.</span><span class="n">saveName</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_mesh_file</span><span class="p">())</span>
		 
	<span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="n">saveDir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">curdir</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">saveName</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">saveDir</span><span class="p">):</span>
			<span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">saveDir</span><span class="p">)</span>
		<span class="n">pymolFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_pymol_file_path</span><span class="p">()</span>
		<span class="n">meshFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_mesh_file_path</span><span class="p">()</span>
		<span class="n">tensor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">tensor</span>

		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;pdb&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
			<span class="n">pdbPath</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">frm_pdb</span><span class="o">.</span><span class="n">prot</span><span class="o">.</span><span class="n">id</span>
			<span class="n">pdbFile</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">pdbPath</span><span class="p">)</span>
			<span class="n">shutil</span><span class="o">.</span><span class="n">copyfile</span><span class="p">(</span><span class="n">pdbPath</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">saveDir</span><span class="p">,</span> <span class="n">pdbFile</span><span class="p">))</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">pdbFile</span> <span class="o">=</span> <span class="kc">None</span>

		<span class="n">mesh</span><span class="p">,</span> <span class="n">bounds</span> <span class="o">=</span> <span class="n">tensor</span><span class="o">.</span><span class="n">make_mesh</span><span class="p">(</span>
			<span class="n">density</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;dens&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">()),</span> 
			<span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
		<span class="n">pcs_mesh</span> <span class="o">=</span> <span class="n">tensor</span><span class="o">.</span><span class="n">pcs_mesh</span><span class="p">(</span><span class="n">mesh</span><span class="p">)</span>
		<span class="n">tensor</span><span class="o">.</span><span class="n">write_isomap</span><span class="p">(</span><span class="n">pcs_mesh</span><span class="p">,</span> <span class="n">bounds</span><span class="p">,</span> <span class="n">fileName</span><span class="o">=</span><span class="n">meshFile</span><span class="p">)</span>
		<span class="n">tensor</span><span class="o">.</span><span class="n">write_pymol_script</span><span class="p">(</span><span class="n">isoval</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;cont&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span> 
			<span class="n">surfaceName</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">saveName</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span><span class="n">scriptName</span><span class="o">=</span><span class="n">pymolFile</span><span class="p">,</span> 
			<span class="n">meshName</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">meshFile</span><span class="p">),</span> 
			<span class="n">pdbFile</span><span class="o">=</span><span class="n">pdbFile</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">death</span><span class="p">()</span>

	<span class="k">def</span> <span class="nf">save_and_call_pymol</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
		<span class="n">subprocess</span><span class="o">.</span><span class="n">call</span><span class="p">([</span><span class="s2">&quot;pymol&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_pymol_file_path</span><span class="p">())])</span></div>


<div class="viewcode-block" id="PlotCorrelationPopup"><a class="viewcode-back" href="../../index.html#paramagpy.gui.PlotCorrelationPopup">[docs]</a><span class="k">class</span> <span class="nc">PlotCorrelationPopup</span><span class="p">(</span><span class="n">Popup</span><span class="p">):</span>
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">):</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="kn">from</span> <span class="nn">matplotlib.backends.backend_tkagg</span> <span class="k">import</span> <span class="n">FigureCanvasTkAgg</span>
			<span class="kn">from</span> <span class="nn">matplotlib.backends.backend_tkagg</span> <span class="k">import</span> <span class="n">NavigationToolbar2Tk</span>
			<span class="kn">from</span> <span class="nn">matplotlib.figure</span> <span class="k">import</span> <span class="n">Figure</span>
			<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="k">import</span> <span class="n">rcParams</span>
		<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
			<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;You need to install matplotlib module for this function&quot;</span><span class="p">)</span>
			<span class="k">raise</span>
		<span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Plot </span><span class="si">{}</span><span class="s2"> correlation&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">parent</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
		<span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">dtype</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">dtype</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">curdir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">loadData</span><span class="o">.</span><span class="n">currentDir</span><span class="p">()</span>
		<span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;savefig.directory&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">curdir</span>
		<span class="c1"># rcParams[&#39;savefig.dpi&#39;] = 300</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>

		<span class="bp">self</span><span class="o">.</span><span class="n">frm_opt</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">frm_opt</span><span class="o">.</span><span class="n">pack</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">frm_plt</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">frm_plt</span><span class="o">.</span><span class="n">pack</span><span class="p">()</span>

		<span class="bp">self</span><span class="o">.</span><span class="n">frm_mff</span> <span class="o">=</span> <span class="n">MultipleFitFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="p">,</span> 
			<span class="n">state</span><span class="o">=</span><span class="s1">&#39;plotting&#39;</span><span class="p">,</span> <span class="n">root</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">frm_opt</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">frm_mff</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">rowspan</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;EW&#39;</span><span class="p">)</span>

		<span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;leg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">IntVar</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
		<span class="n">chk</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Checkbutton</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frm_opt</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Include Legend&quot;</span><span class="p">,</span>
			<span class="n">variable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;leg&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;W&#39;</span><span class="p">)</span>

		<span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;inf&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">IntVar</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
		<span class="n">chk</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Checkbutton</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frm_opt</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Include Tensor info.&quot;</span><span class="p">,</span>
			<span class="n">variable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;inf&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;W&#39;</span><span class="p">)</span>

		<span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;ann&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">IntVar</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
		<span class="n">chk</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Checkbutton</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frm_opt</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Include Atom info.&quot;</span><span class="p">,</span>
			<span class="n">variable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;ann&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;W&#39;</span><span class="p">)</span>

		<span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;avg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">IntVar</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
		<span class="n">chk</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Checkbutton</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frm_opt</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Average Models&quot;</span><span class="p">,</span>
			<span class="n">variable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;avg&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;W&#39;</span><span class="p">)</span>

		<span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frm_opt</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\u2193</span><span class="s1">   Re-plot   </span><span class="se">\u2193</span><span class="s1">&#39;</span><span class="p">,</span> 
			<span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">columnspan</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;EW&#39;</span><span class="p">)</span>

		<span class="bp">self</span><span class="o">.</span><span class="n">fig</span> <span class="o">=</span> <span class="n">Figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">tight_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">axes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">canvas</span> <span class="o">=</span> <span class="n">FigureCanvasTkAgg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="p">,</span> <span class="n">master</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">frm_plt</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">get_tk_widget</span><span class="p">()</span><span class="o">.</span><span class="n">pack</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">toolbar</span> <span class="o">=</span> <span class="n">NavigationToolbar2Tk</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">frm_plt</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">toolbar</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>

		<span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">frm_mff</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>


	<span class="k">def</span> <span class="nf">last_words</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">frm_mff</span><span class="o">.</span><span class="n">remove_traces</span><span class="p">()</span>

	<span class="nd">@staticmethod</span>
	<span class="k">def</span> <span class="nf">format_coord</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
		<span class="k">return</span> <span class="s2">&quot;Exp: </span><span class="si">{0:5.2f}</span><span class="s2">, Cal:</span><span class="si">{1:5.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

	<span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Experiment&quot;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Calculated&quot;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">format_coord</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">format_coord</span>

		<span class="k">for</span> <span class="n">tab</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">frm_mff</span><span class="o">.</span><span class="n">get_chosen_tabs</span><span class="p">():</span>
			<span class="k">if</span> <span class="n">tab</span><span class="o">.</span><span class="n">data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
				<span class="k">continue</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;avg&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
				<span class="n">data</span> <span class="o">=</span> <span class="n">tab</span><span class="o">.</span><span class="n">get_model_average</span><span class="p">()</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">data</span> <span class="o">=</span> <span class="n">tab</span><span class="o">.</span><span class="n">data</span>
			<span class="n">d</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;use&#39;</span><span class="p">]</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;exp&#39;</span><span class="p">])]</span>
			<span class="n">mini</span> <span class="o">=</span> <span class="nb">min</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;exp&#39;</span><span class="p">,</span><span class="s1">&#39;cal&#39;</span><span class="p">]])</span>
			<span class="n">maxi</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;exp&#39;</span><span class="p">,</span><span class="s1">&#39;cal&#39;</span><span class="p">]])</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">mini</span><span class="p">,</span><span class="n">maxi</span><span class="p">],</span> <span class="p">[</span><span class="n">mini</span><span class="p">,</span><span class="n">maxi</span><span class="p">],</span> <span class="s1">&#39;-k&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;exp&#39;</span><span class="p">],</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;cal&#39;</span><span class="p">],</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
				<span class="n">label</span><span class="o">=</span><span class="n">tab</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">tab</span><span class="o">.</span><span class="n">colour</span><span class="o">.</span><span class="n">colour</span><span class="p">)</span>

			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;ann&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
				<span class="k">for</span> <span class="n">atom</span><span class="p">,</span> <span class="n">exp</span><span class="p">,</span> <span class="n">cal</span> <span class="ow">in</span> <span class="n">d</span><span class="p">[[</span><span class="s1">&#39;atm&#39;</span><span class="p">,</span><span class="s1">&#39;exp&#39;</span><span class="p">,</span><span class="s1">&#39;cal&#39;</span><span class="p">]]:</span>
					<span class="n">_</span><span class="p">,</span> <span class="n">mdl</span><span class="p">,</span> <span class="n">chn</span><span class="p">,</span> <span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">seq</span><span class="p">,</span> <span class="n">_</span><span class="p">),</span> <span class="p">(</span><span class="n">atm</span><span class="p">,</span> <span class="n">_</span><span class="p">)</span> <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">get_full_id</span><span class="p">()</span>
					<span class="n">s</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">atm</span><span class="p">,</span><span class="n">seq</span><span class="p">)</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">exp</span><span class="p">,</span> <span class="n">cal</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>

			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;leg&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">0.95</span><span class="p">,</span><span class="mf">0.05</span><span class="p">),</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;lower right&quot;</span><span class="p">)</span>

			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;inf&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
				<span class="n">s</span> <span class="o">=</span> <span class="n">tab</span><span class="o">.</span><span class="n">tensorFit</span><span class="o">.</span><span class="n">tensor</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">comment</span><span class="o">=</span><span class="kc">False</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">family</span><span class="o">=</span><span class="s1">&#39;monospace&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mf">6.5</span><span class="p">,</span>
					<span class="n">bbox</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;facecolor&#39;</span><span class="p">:</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="s1">&#39;pad&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">},</span>
					<span class="n">transform</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> 
					<span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">)</span>

		<span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span></div>


<div class="viewcode-block" id="SaveDataPopup"><a class="viewcode-back" href="../../index.html#paramagpy.gui.SaveDataPopup">[docs]</a><span class="k">class</span> <span class="nc">SaveDataPopup</span><span class="p">(</span><span class="n">Popup</span><span class="p">):</span>
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">):</span>
		<span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Save </span><span class="si">{}</span><span class="s2"> </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">parent</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
		<span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>

		<span class="bp">self</span><span class="o">.</span><span class="n">curdir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">loadData</span><span class="o">.</span><span class="n">currentDir</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">default_fileName</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="s2">&quot;_&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>

		<span class="bp">self</span><span class="o">.</span><span class="n">varFileType</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s2">&quot;.npc&quot;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">varAverage</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s1">&#39;average&#39;</span><span class="p">)</span>

		<span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;File type:&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span>
			<span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;E&#39;</span><span class="p">)</span>
		<span class="n">ttk</span><span class="o">.</span><span class="n">Radiobutton</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;.npc&#39;</span><span class="p">,</span> <span class="n">variable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">varFileType</span><span class="p">,</span> 
			<span class="n">value</span><span class="o">=</span><span class="s1">&#39;.npc&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;W&#39;</span><span class="p">)</span>
		<span class="n">ttk</span><span class="o">.</span><span class="n">Radiobutton</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;.csv&#39;</span><span class="p">,</span> <span class="n">variable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">varFileType</span><span class="p">,</span> 
			<span class="n">value</span><span class="o">=</span><span class="s1">&#39;.csv&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;W&#39;</span><span class="p">)</span>

		<span class="n">ttk</span><span class="o">.</span><span class="n">Separator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span>
			<span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">columnspan</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;ew&#39;</span><span class="p">)</span>

		<span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Models:&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span>
			<span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;E&#39;</span><span class="p">)</span>
		<span class="n">ttk</span><span class="o">.</span><span class="n">Radiobutton</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">variable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">varAverage</span><span class="p">,</span> 
			<span class="n">value</span><span class="o">=</span><span class="s1">&#39;average&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;W&#39;</span><span class="p">)</span>
		<span class="n">ttk</span><span class="o">.</span><span class="n">Radiobutton</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Current&#39;</span><span class="p">,</span> <span class="n">variable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">varAverage</span><span class="p">,</span> 
			<span class="n">value</span><span class="o">=</span><span class="s1">&#39;current&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;W&#39;</span><span class="p">)</span>

		<span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Cancel&#39;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">death</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
		<span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Save&#39;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">save</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

		<span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>

	<span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;defaultextension&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">varFileType</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span> 
			<span class="s1">&#39;initialdir&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">curdir</span><span class="p">,</span> 
			<span class="s1">&#39;initialfile&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">default_fileName</span><span class="p">}</span>
		<span class="n">fileName</span> <span class="o">=</span> <span class="n">filedialog</span><span class="o">.</span><span class="n">asksaveasfilename</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="n">fileName</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">death</span><span class="p">()</span>
			<span class="k">return</span>

		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">varAverage</span><span class="o">.</span><span class="n">get</span><span class="p">()</span><span class="o">==</span><span class="s1">&#39;current&#39;</span><span class="p">:</span>
			<span class="n">tmp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">data</span>
			<span class="n">data</span> <span class="o">=</span> <span class="n">tmp</span><span class="p">[</span><span class="n">tmp</span><span class="p">[</span><span class="s1">&#39;mdl&#39;</span><span class="p">]</span><span class="o">==</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">currentModel</span><span class="o">.</span><span class="n">get</span><span class="p">()]</span>
		<span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">varAverage</span><span class="o">.</span><span class="n">get</span><span class="p">()</span><span class="o">==</span><span class="s1">&#39;average&#39;</span><span class="p">:</span>
			<span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">get_model_average</span><span class="p">()</span>

		<span class="n">outData</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">varFileType</span><span class="o">.</span><span class="n">get</span><span class="p">()</span><span class="o">==</span><span class="s1">&#39;.csv&#39;</span><span class="p">:</span>
			<span class="n">outData</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">lblLine</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;|&quot;</span><span class="p">,</span><span class="s2">&quot;,&quot;</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
			<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
				<span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">chn</span><span class="p">,</span> <span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">seq</span><span class="p">,</span> <span class="n">_</span><span class="p">),</span> <span class="p">(</span><span class="n">atm</span><span class="p">,</span> <span class="n">_</span><span class="p">)</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;atm&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_full_id</span><span class="p">()</span>
				<span class="n">res</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;atm&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">resname</span>
				<span class="n">expn</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:^9.3f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;exp&#39;</span><span class="p">])</span>
				<span class="n">caln</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:^9.3f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;cal&#39;</span><span class="p">])</span>
				<span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;use&#39;</span><span class="p">]:</span>
					<span class="n">use</span> <span class="o">=</span> <span class="s1">&#39;x&#39;</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="n">use</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span>
				<span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">fmtLine</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
					<span class="n">use</span><span class="p">,</span><span class="n">chn</span><span class="p">,</span><span class="n">seq</span><span class="p">,</span><span class="n">res</span><span class="p">,</span><span class="n">atm</span><span class="p">,</span><span class="n">expn</span><span class="p">,</span><span class="n">caln</span><span class="p">)</span>
				<span class="n">outData</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;|&quot;</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

		<span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">varFileType</span><span class="o">.</span><span class="n">get</span><span class="p">()</span><span class="o">==</span><span class="s1">&#39;.npc&#39;</span><span class="p">:</span>
			<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
				<span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">chn</span><span class="p">,</span> <span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">seq</span><span class="p">,</span> <span class="n">_</span><span class="p">),</span> <span class="p">(</span><span class="n">atm</span><span class="p">,</span> <span class="n">_</span><span class="p">)</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;atm&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_full_id</span><span class="p">()</span>
				<span class="n">line</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{0:&lt;4d}{1:&lt;5}{2:11.5f}{3:11.5f}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
					<span class="n">seq</span><span class="p">,</span> <span class="n">atm</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;cal&#39;</span><span class="p">],</span> <span class="mf">0.0</span><span class="p">)</span>
				<span class="n">outData</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>

		<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fileName</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">o</span><span class="p">:</span>
			<span class="n">o</span><span class="o">.</span><span class="n">writelines</span><span class="p">(</span><span class="n">outData</span><span class="p">)</span>

		<span class="bp">self</span><span class="o">.</span><span class="n">death</span><span class="p">()</span></div>


<div class="viewcode-block" id="SelectionPopup"><a class="viewcode-back" href="../../index.html#paramagpy.gui.SelectionPopup">[docs]</a><span class="k">class</span> <span class="nc">SelectionPopup</span><span class="p">(</span><span class="n">Popup</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;A popup allowing atom and residue selection for experimental data&quot;&quot;&quot;</span>
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">):</span>
		<span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Atoms and residues for fitting&quot;</span>
		<span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>
		<span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Atom:&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;W&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">atoms</span> <span class="o">=</span> <span class="p">{}</span>
		<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">atom</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="s1">&#39;H&#39;</span><span class="p">,</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="s1">&#39;O&#39;</span><span class="p">]):</span>
			<span class="k">if</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">parent</span><span class="o">.</span><span class="n">atom_selection</span><span class="p">:</span>
				<span class="n">value</span> <span class="o">=</span> <span class="kc">True</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">value</span> <span class="o">=</span> <span class="kc">False</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="n">atom</span><span class="p">]</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">BooleanVar</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="n">value</span><span class="p">)</span>
			<span class="n">ttk</span><span class="o">.</span><span class="n">Checkbutton</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">atom</span><span class="p">,</span><span class="n">variable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="n">atom</span><span class="p">]</span>
				<span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;W&#39;</span><span class="p">)</span>

		<span class="n">ttk</span><span class="o">.</span><span class="n">Separator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span>
			<span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">rowspan</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;NS&#39;</span><span class="p">)</span>

		<span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Residue:&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">columnspan</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;W&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">residues</span> <span class="o">=</span> <span class="p">{}</span>
		<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">residue</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">protein</span><span class="o">.</span><span class="n">standard_aa_names</span><span class="p">):</span>
			<span class="k">if</span> <span class="n">residue</span> <span class="ow">in</span> <span class="n">parent</span><span class="o">.</span><span class="n">resi_selection</span><span class="p">:</span>
				<span class="n">value</span> <span class="o">=</span> <span class="kc">True</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">value</span> <span class="o">=</span> <span class="kc">False</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">residues</span><span class="p">[</span><span class="n">residue</span><span class="p">]</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">BooleanVar</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="n">value</span><span class="p">)</span>
			<span class="n">ttk</span><span class="o">.</span><span class="n">Checkbutton</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">residue</span><span class="p">,</span><span class="n">variable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">residues</span><span class="p">[</span><span class="n">residue</span><span class="p">]</span>
				<span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">i</span><span class="o">%</span><span class="mi">4</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="o">+</span><span class="n">i</span><span class="o">//</span><span class="mi">4</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;W&#39;</span><span class="p">,</span><span class="n">padx</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

		<span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Cancel&#39;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">death</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
		<span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Save&#39;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">save</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>

	<span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">atom_selection</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span>
			<span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">j</span><span class="o">.</span><span class="n">get</span><span class="p">()])</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">resi_selection</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span>
			<span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">residues</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">j</span><span class="o">.</span><span class="n">get</span><span class="p">()])</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">update_views</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">death</span><span class="p">()</span></div>


<div class="viewcode-block" id="ErrorSimulationPopup"><a class="viewcode-back" href="../../index.html#paramagpy.gui.ErrorSimulationPopup">[docs]</a><span class="k">class</span> <span class="nc">ErrorSimulationPopup</span><span class="p">(</span><span class="n">Popup</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;A popup allowing atom and residue selection for experimental data&quot;&quot;&quot;</span>
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">):</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="kn">from</span> <span class="nn">matplotlib.backends.backend_tkagg</span> <span class="k">import</span> <span class="n">FigureCanvasTkAgg</span>
			<span class="kn">from</span> <span class="nn">matplotlib.backends.backend_tkagg</span> <span class="k">import</span> <span class="n">NavigationToolbar2Tk</span>
			<span class="kn">from</span> <span class="nn">matplotlib.figure</span> <span class="k">import</span> <span class="n">Figure</span>
			<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="k">import</span> <span class="n">rcParams</span>
		<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
			<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;You need to install matplotlib module for this function&quot;</span><span class="p">)</span>
			<span class="k">raise</span>
		<span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Monte Carlo Uncertianty Simulation&quot;</span>
		<span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>

		<span class="bp">self</span><span class="o">.</span><span class="n">frm_left</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">frm_opt</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frm_left</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">frm_disp</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frm_left</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">frm_left</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">frm_opt</span><span class="o">.</span><span class="n">pack</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">frm_disp</span><span class="o">.</span><span class="n">pack</span><span class="p">()</span>

		<span class="bp">self</span><span class="o">.</span><span class="n">startTensor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">tensor</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">errorTensor</span> <span class="o">=</span> <span class="n">metal</span><span class="o">.</span><span class="n">Metal</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">errorTensor</span><span class="o">.</span><span class="n">temperature</span> <span class="o">=</span> <span class="mf">0.0</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">errorTensor</span><span class="o">.</span><span class="n">B0</span> <span class="o">=</span> <span class="mf">0.0</span>

		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;PCS&#39;</span><span class="p">,</span><span class="s1">&#39;PRE&#39;</span><span class="p">]:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">varMulti</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">BooleanVar</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
			<span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frm_opt</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Fitting:&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span>
				<span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;W&#39;</span><span class="p">)</span>
			<span class="n">ttk</span><span class="o">.</span><span class="n">Radiobutton</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frm_opt</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Use Single Fit&#39;</span><span class="p">,</span> <span class="n">variable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">varMulti</span><span class="p">,</span> 
				<span class="n">value</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;W&#39;</span><span class="p">)</span>
			<span class="n">ttk</span><span class="o">.</span><span class="n">Radiobutton</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frm_opt</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Use Multiple Fit&#39;</span><span class="p">,</span> <span class="n">variable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">varMulti</span><span class="p">,</span> 
				<span class="n">value</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;W&#39;</span><span class="p">)</span>

		<span class="n">ttk</span><span class="o">.</span><span class="n">Separator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frm_opt</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span>
			<span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">rowspan</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;ns&#39;</span><span class="p">)</span>

		<span class="bp">self</span><span class="o">.</span><span class="n">varAverage</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">BooleanVar</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
		<span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frm_opt</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Models:&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span>
			<span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;W&#39;</span><span class="p">)</span>
		<span class="n">ttk</span><span class="o">.</span><span class="n">Radiobutton</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frm_opt</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Ensemble Average&#39;</span><span class="p">,</span> 
			<span class="n">variable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">varAverage</span><span class="p">,</span> 
			<span class="n">value</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;W&#39;</span><span class="p">)</span>
		<span class="n">ttk</span><span class="o">.</span><span class="n">Radiobutton</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frm_opt</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Use Current Model&#39;</span><span class="p">,</span> 
			<span class="n">variable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">varAverage</span><span class="p">,</span> 
			<span class="n">value</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;W&#39;</span><span class="p">)</span>

		<span class="n">ttk</span><span class="o">.</span><span class="n">Separator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frm_opt</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span>
			<span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">rowspan</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;ns&#39;</span><span class="p">)</span>

		<span class="bp">self</span><span class="o">.</span><span class="n">var_error_method</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s1">&#39;mc&#39;</span><span class="p">)</span>

		<span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frm_opt</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Method:&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span>
			<span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;W&#39;</span><span class="p">)</span>
		<span class="n">ttk</span><span class="o">.</span><span class="n">Radiobutton</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frm_opt</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Monte Carlo&#39;</span><span class="p">,</span> 
			<span class="n">variable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">var_error_method</span><span class="p">,</span> 
			<span class="n">value</span><span class="o">=</span><span class="s1">&#39;mc&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;W&#39;</span><span class="p">)</span>
		<span class="n">ttk</span><span class="o">.</span><span class="n">Radiobutton</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frm_opt</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Bootstrap&#39;</span><span class="p">,</span> 
			<span class="n">variable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">var_error_method</span><span class="p">,</span> 
			<span class="n">value</span><span class="o">=</span><span class="s1">&#39;bs&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;W&#39;</span><span class="p">)</span>

		<span class="n">ttk</span><span class="o">.</span><span class="n">Separator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frm_opt</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span>
			<span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">rowspan</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;ns&#39;</span><span class="p">)</span>

		<span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frm_opt</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Parameters:&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span>
			<span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span><span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;W&#39;</span><span class="p">)</span>
		<span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frm_opt</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Iters:&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span>
			<span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span><span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;W&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">iterations</span> <span class="o">=</span> <span class="n">NumericEntry</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frm_opt</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> 
			<span class="n">formatter</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">{:d}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">onlyPositive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">iterations</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;W&#39;</span><span class="p">)</span>
		<span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frm_opt</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Frac:&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span>
			<span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span><span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;W&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">bootfrac</span> <span class="o">=</span> <span class="n">NumericEntry</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frm_opt</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> 
			<span class="n">formatter</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">{:.3f}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span> <span class="n">onlyPositive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">bootfrac</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;W&#39;</span><span class="p">)</span>
		
		<span class="n">ttk</span><span class="o">.</span><span class="n">Separator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frm_opt</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span>
			<span class="n">row</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">columnspan</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span><span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;ew&#39;</span><span class="p">)</span>

		<span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frm_opt</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Run&#39;</span><span class="p">,</span> 
			<span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">run</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">columnspan</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span><span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;EW&#39;</span><span class="p">)</span>

		<span class="bp">self</span><span class="o">.</span><span class="n">textbox</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="s2">&quot;disabled&quot;</span><span class="p">,</span> 
			<span class="n">width</span><span class="o">=</span><span class="mi">29</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">29</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">textbox</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>

		<span class="bp">self</span><span class="o">.</span><span class="n">fig</span> <span class="o">=</span> <span class="n">Figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span><span class="c1">#, tight_layout=True)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">axes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;hammer&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">canvas</span> <span class="o">=</span> <span class="n">FigureCanvasTkAgg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="p">,</span> <span class="n">master</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">frm_disp</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">get_tk_widget</span><span class="p">()</span><span class="o">.</span><span class="n">pack</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">toolbar</span> <span class="o">=</span> <span class="n">NavigationToolbar2Tk</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">frm_disp</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">toolbar</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>

		<span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">type_tensors</span><span class="p">()</span>

	<span class="k">def</span> <span class="nf">type_tensors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
		<span class="n">s</span> <span class="o">=</span> <span class="s2">&quot;Fitted Tensor:</span><span class="se">\n</span><span class="s2">&quot;</span>
		<span class="n">s</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">startTensor</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">comment</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
		<span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Error Tensor:</span><span class="se">\n</span><span class="s2">&quot;</span>
		<span class="n">s</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">errorTensor</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">comment</span><span class="o">=</span><span class="kc">False</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">textbox</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="s1">&#39;normal&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">textbox</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span><span class="n">tk</span><span class="o">.</span><span class="n">END</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">textbox</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">tk</span><span class="o">.</span><span class="n">END</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">textbox</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="s1">&#39;disabled&#39;</span><span class="p">)</span>

	<span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">varMulti</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
			<span class="n">dataTabs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">frm_fmul</span><span class="o">.</span><span class="n">get_chosen_tabs</span><span class="p">()</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">dataTabs</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="p">]</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">varAverage</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
			<span class="n">model</span> <span class="o">=</span> <span class="kc">None</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">viewData</span><span class="o">.</span><span class="n">currentModel</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>

		<span class="n">method</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_error_method</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
		<span class="n">iters</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">iterations</span><span class="o">.</span><span class="n">floatVar</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
		<span class="n">bsfrac</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bootfrac</span><span class="o">.</span><span class="n">floatVar</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>

		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">dtype</span><span class="o">==</span><span class="s1">&#39;PCS&#39;</span><span class="p">:</span>
			<span class="n">stds</span><span class="p">,</span> <span class="n">devs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">fopts</span><span class="o">.</span><span class="n">error_pcs</span><span class="p">(</span><span class="n">dataTabs</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">iters</span><span class="p">,</span> 
				<span class="n">bsfrac</span><span class="o">=</span><span class="n">bsfrac</span><span class="p">,</span> <span class="n">singleModel</span><span class="o">=</span><span class="n">model</span><span class="p">)</span>
		<span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">dtype</span><span class="o">==</span><span class="s1">&#39;PRE&#39;</span><span class="p">:</span>
			<span class="k">pass</span>



		<span class="bp">self</span><span class="o">.</span><span class="n">errorTensor</span><span class="o">.</span><span class="n">set_params</span><span class="p">(</span><span class="n">devs</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
		<span class="k">def</span> <span class="nf">transform</span><span class="p">(</span><span class="n">vector</span><span class="p">):</span>
			<span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">vector</span>
			<span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
			<span class="n">phi</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">2.</span>
			<span class="k">return</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span>

		<span class="n">spcoords</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">for</span> <span class="n">eulers</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">stds</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">],</span> <span class="n">stds</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">],</span> <span class="n">stds</span><span class="p">[</span><span class="s1">&#39;g&#39;</span><span class="p">]):</span>
			<span class="n">rotationMatrix</span> <span class="o">=</span> <span class="n">metal</span><span class="o">.</span><span class="n">euler_to_matrix</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">eulers</span><span class="p">))</span>
			<span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">rotationMatrix</span><span class="o">.</span><span class="n">T</span>
			<span class="n">spcoords</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">transform</span><span class="p">,</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">])))</span>

		<span class="bp">self</span><span class="o">.</span><span class="n">type_tensors</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">spcoords</span><span class="p">))</span>

	<span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">points</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;theta&quot;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;phi&quot;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>

		<span class="k">if</span> <span class="n">points</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
			<span class="k">for</span> <span class="n">data</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="s1">&#39;g&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="p">]):</span>
				<span class="n">theta</span><span class="p">,</span> <span class="n">phi</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">data</span><span class="p">)</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">col</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>
				<span class="c1"># self.axes.plot(theta, phi, marker=&#39;x&#39;,</span>
					<span class="c1"># lw=0, ms=3, label=label, color=col)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span></div>


<div class="viewcode-block" id="MorePopup"><a class="viewcode-back" href="../../index.html#paramagpy.gui.MorePopup">[docs]</a><span class="k">class</span> <span class="nc">MorePopup</span><span class="p">(</span><span class="n">Popup</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;A popup containing lots of information about the tensor&quot;&quot;&quot;</span>
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">):</span>
		<span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;More tensor information&quot;</span>
		<span class="n">tensor</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">tensor</span>
		<span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">55</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="s2">&quot;Courier 10&quot;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">tag_configure</span><span class="p">(</span><span class="s2">&quot;bold&quot;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="s2">&quot;Courier 10 bold&quot;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">entry</span><span class="p">(</span><span class="s2">&quot;Basic info.:&quot;</span><span class="p">,</span> <span class="n">tensor</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">comment</span><span class="o">=</span><span class="kc">False</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">entry</span><span class="p">(</span><span class="s2">&quot;Eigenvalues [dx,dy,dz]:&quot;</span><span class="p">,</span> <span class="n">tensor</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">entry</span><span class="p">(</span><span class="s2">&quot;Delta Chi Tensor:&quot;</span><span class="p">,</span> <span class="n">tensor</span><span class="o">.</span><span class="n">tensor_traceless</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">entry</span><span class="p">(</span><span class="s2">&quot;Chi Tensor:&quot;</span><span class="p">,</span> <span class="n">tensor</span><span class="o">.</span><span class="n">tensor</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">entry</span><span class="p">(</span><span class="s2">&quot;Isotropy:&quot;</span><span class="p">,</span> <span class="n">tensor</span><span class="o">.</span><span class="n">isotropy</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">entry</span><span class="p">(</span><span class="s2">&quot;Rotation matrix:&quot;</span><span class="p">,</span> <span class="n">tensor</span><span class="o">.</span><span class="n">rotationMatrix</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">entry</span><span class="p">(</span><span class="s2">&quot;Saupe tensor:&quot;</span><span class="p">,</span> <span class="n">tensor</span><span class="o">.</span><span class="n">tensor_saupe</span><span class="p">)</span>

		<span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">expand</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>

	<span class="k">def</span> <span class="nf">entry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">tk</span><span class="o">.</span><span class="n">END</span><span class="p">,</span> <span class="n">title</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s2">&quot;bold&quot;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">tk</span><span class="o">.</span><span class="n">END</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">text</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="DataLoad"><a class="viewcode-back" href="../../index.html#paramagpy.gui.DataLoad">[docs]</a><span class="k">class</span> <span class="nc">DataLoad</span><span class="p">(</span><span class="n">tk</span><span class="o">.</span><span class="n">LabelFrame</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	For loading PCS, RDC and PRE data and parsing to &lt;data&gt;</span>
<span class="sd">	data : dictionary of {(sequence, atomName) : value}</span>
<span class="sd">	&quot;&quot;&quot;</span>
	<span class="n">GAMMAH</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mf">42.576E6</span>

	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">):</span>
		<span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Experimental Data&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span> <span class="c1"># DataTab</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">dtype</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">dtype</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">pathWidth</span> <span class="o">=</span> <span class="mi">20</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">dataparse</span><span class="o">.</span><span class="n">DataContainer</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">fields</span> <span class="o">=</span> <span class="p">{}</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">currentFile</span> <span class="o">=</span> <span class="kc">None</span>

		<span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Read </span><span class="si">{}</span><span class="s1"> Data&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">),</span>
			<span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">load_data</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

		<span class="bp">self</span><span class="o">.</span><span class="n">lbl_dataFile</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">pathWidth</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">lbl_dataFile</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">columnspan</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

		<span class="k">def</span> <span class="nf">parse</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
			<span class="n">mag</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mf">1E6</span> <span class="o">*</span> <span class="n">value</span><span class="p">)</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">GAMMAH</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">tensorStart</span><span class="o">.</span><span class="n">tensor</span><span class="o">.</span><span class="n">B0</span> <span class="o">=</span> <span class="n">mag</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">tensorFit</span><span class="o">.</span><span class="n">tensor</span><span class="o">.</span><span class="n">B0</span> <span class="o">=</span> <span class="n">mag</span>
		<span class="k">def</span> <span class="nf">disp</span><span class="p">():</span>
			<span class="n">mag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">tensorFit</span><span class="o">.</span><span class="n">tensor</span><span class="o">.</span><span class="n">B0</span>
			<span class="k">return</span> <span class="p">(</span><span class="n">mag</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">GAMMAH</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mf">1E6</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="s1">&#39;mag&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">NumericEntry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parse</span><span class="p">,</span> 
			<span class="n">disp</span><span class="p">,</span> <span class="n">onlyPositive</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">formatter</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">{:.1f}</span><span class="s2">&quot;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="s1">&#39;mag&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;B0/Tesla&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="s1">&#39;mag&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="s1">&#39;mag&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

		<span class="k">def</span> <span class="nf">parse</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">tensorStart</span><span class="o">.</span><span class="n">tensor</span><span class="o">.</span><span class="n">temperature</span> <span class="o">=</span> <span class="n">value</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">tensorFit</span><span class="o">.</span><span class="n">tensor</span><span class="o">.</span><span class="n">temperature</span> <span class="o">=</span> <span class="n">value</span>
		<span class="k">def</span> <span class="nf">disp</span><span class="p">():</span>
			<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">tensorFit</span><span class="o">.</span><span class="n">tensor</span><span class="o">.</span><span class="n">temperature</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="s1">&#39;tem&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">NumericEntry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parse</span><span class="p">,</span> 
			<span class="n">disp</span><span class="p">,</span> <span class="n">onlyPositive</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">formatter</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="s1">&#39;tem&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Temp./K&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="s1">&#39;tem&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="s1">&#39;tem&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="o">==</span><span class="s1">&#39;PRE&#39;</span><span class="p">:</span>
			<span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Relaxation Type:&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">rtype_var</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s1">&#39;r2&#39;</span><span class="p">)</span>
			<span class="n">ttk</span><span class="o">.</span><span class="n">Radiobutton</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;R1&#39;</span><span class="p">,</span> <span class="n">variable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">rtype_var</span><span class="p">,</span> 
				<span class="n">value</span><span class="o">=</span><span class="s1">&#39;r1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;W&#39;</span><span class="p">)</span>
			<span class="n">ttk</span><span class="o">.</span><span class="n">Radiobutton</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;R2&#39;</span><span class="p">,</span> <span class="n">variable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">rtype_var</span><span class="p">,</span> 
				<span class="n">value</span><span class="o">=</span><span class="s1">&#39;r2&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;W&#39;</span><span class="p">)</span>

	<span class="k">def</span> <span class="nf">rtype</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="o">==</span><span class="s1">&#39;PRE&#39;</span><span class="p">:</span>
			<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rtype_var</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="k">return</span> <span class="kc">None</span>

	<span class="k">def</span> <span class="nf">currentDir</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentFile</span><span class="p">:</span>
			<span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentFile</span><span class="p">)</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>

	<span class="k">def</span> <span class="nf">load_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="n">filedict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;PCS&#39;</span><span class="p">:</span><span class="s1">&#39;.npc&#39;</span><span class="p">,</span><span class="s1">&#39;RDC&#39;</span><span class="p">:</span><span class="s1">&#39;.rdc&#39;</span><span class="p">,</span><span class="s1">&#39;PRE&#39;</span><span class="p">:</span><span class="s1">&#39;.npc&#39;</span><span class="p">}</span>
		<span class="n">fileName</span> <span class="o">=</span> <span class="n">filedialog</span><span class="o">.</span><span class="n">askopenfilename</span><span class="p">(</span>
			<span class="n">title</span><span class="o">=</span><span class="s2">&quot;Choose </span><span class="si">{}</span><span class="s2"> file&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">),</span>
			<span class="n">defaultextension</span><span class="o">=</span><span class="n">filedict</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">],</span>
			<span class="n">filetypes</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> file&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">filedict</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">]),</span>
				<span class="n">filedict</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">]),(</span><span class="s1">&#39;All files&#39;</span><span class="p">,</span><span class="s1">&#39;*.*&#39;</span><span class="p">)])</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="n">fileName</span><span class="p">:</span>
			<span class="k">return</span>
		<span class="k">if</span> <span class="n">fileName</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="o">==</span><span class="s1">&#39;PCS&#39;</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">dataparse</span><span class="o">.</span><span class="n">read_pcs</span><span class="p">(</span><span class="n">fileName</span><span class="p">)</span>
		<span class="k">elif</span> <span class="n">fileName</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="o">==</span><span class="s1">&#39;RDC&#39;</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">dataparse</span><span class="o">.</span><span class="n">read_rdc</span><span class="p">(</span><span class="n">fileName</span><span class="p">)</span>
		<span class="k">elif</span> <span class="n">fileName</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="o">==</span><span class="s1">&#39;PRE&#39;</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">dataparse</span><span class="o">.</span><span class="n">read_pre</span><span class="p">(</span><span class="n">fileName</span><span class="p">)</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">dataparse</span><span class="o">.</span><span class="n">DataContainer</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">lbl_dataFile</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">format_path</span><span class="p">(</span><span class="n">fileName</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pathWidth</span><span class="p">))</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">currentFile</span> <span class="o">=</span> <span class="n">fileName</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span></div>


<div class="viewcode-block" id="Treeviewer"><a class="viewcode-back" href="../../index.html#paramagpy.gui.Treeviewer">[docs]</a><span class="k">class</span> <span class="nc">Treeviewer</span><span class="p">(</span><span class="n">ttk</span><span class="o">.</span><span class="n">Treeview</span><span class="p">):</span>
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">root</span><span class="p">,</span> <span class="n">columns</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">fields</span> <span class="o">=</span> <span class="n">columns</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">data_reference</span> <span class="o">=</span> <span class="p">{}</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span> <span class="mi">0</span>

		<span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> 
			<span class="n">show</span><span class="o">=</span><span class="s1">&#39;headings&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

		<span class="k">for</span> <span class="n">col</span><span class="p">,</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">formatter</span><span class="p">,</span> <span class="n">length</span><span class="p">)</span> <span class="ow">in</span> <span class="n">columns</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">heading</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
				<span class="n">command</span><span class="o">=</span><span class="k">lambda</span> <span class="n">c</span><span class="o">=</span><span class="n">col</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="kc">True</span><span class="p">))</span>
			<span class="n">pixels</span> <span class="o">=</span> <span class="n">font</span><span class="o">.</span><span class="n">Font</span><span class="p">()</span><span class="o">.</span><span class="n">measure</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="o">*</span><span class="n">length</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">minwidth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">pixels</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="s1">&#39;NO&#39;</span><span class="p">)</span>

		<span class="bp">self</span><span class="o">.</span><span class="n">last_sort</span> <span class="o">=</span> <span class="kc">None</span>

	<span class="k">def</span> <span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">get_children</span><span class="p">())</span>

	<span class="k">def</span> <span class="nf">set_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
		<span class="n">data_ref</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">fd</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
			<span class="n">row</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">fd</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>
			<span class="n">data_ref</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">fd</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;end&#39;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="n">row</span><span class="p">,</span> <span class="n">iid</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">data_reference</span> <span class="o">=</span> <span class="p">{}</span>
		<span class="k">for</span> <span class="n">column</span><span class="p">,</span> <span class="n">values</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">data_ref</span><span class="p">)):</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">data_reference</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>

	<span class="k">def</span> <span class="nf">sort</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">reverse</span><span class="p">):</span>
		<span class="n">idxs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_reference</span><span class="p">[</span><span class="n">column</span><span class="p">])</span>
		<span class="k">if</span> <span class="n">reverse</span><span class="p">:</span>
			<span class="n">idxs</span> <span class="o">=</span> <span class="n">idxs</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

		<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">iid</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">idxs</span><span class="p">):</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">iid</span><span class="p">),</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>

		<span class="bp">self</span><span class="o">.</span><span class="n">last_sort</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">c</span><span class="o">=</span><span class="n">column</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">reverse</span><span class="p">)</span>
		<span class="n">next_sort</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">c</span><span class="o">=</span><span class="n">column</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="ow">not</span> <span class="n">reverse</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">heading</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="n">next_sort</span><span class="p">)</span>

	<span class="k">def</span> <span class="nf">sort_previous</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">last_sort</span><span class="p">()</span></div>


<div class="viewcode-block" id="DataView"><a class="viewcode-back" href="../../index.html#paramagpy.gui.DataView">[docs]</a><span class="k">class</span> <span class="nc">DataView</span><span class="p">(</span><span class="n">tk</span><span class="o">.</span><span class="n">LabelFrame</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	A listbox to view pdb and experimental data in rows</span>
<span class="sd">	&quot;&quot;&quot;</span>
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">):</span>
		<span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;View Data&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span> <span class="c1"># DataTab</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">dtype</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">dtype</span>

		<span class="bp">self</span><span class="o">.</span><span class="n">fmt_qfac</span> <span class="o">=</span> <span class="s2">&quot;Q factor: </span><span class="si">{:.4f}</span><span class="s2">&quot;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">fields</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">([</span>
			<span class="p">[</span><span class="s1">&#39;use&#39;</span><span class="p">,(</span><span class="s1">&#39;?&#39;</span>    <span class="p">,</span><span class="s1">&#39;</span><span class="si">{:^1}</span><span class="s1">&#39;</span>  <span class="p">,</span> <span class="mi">2</span><span class="p">)],</span>
			<span class="p">[</span><span class="s1">&#39;chn&#39;</span><span class="p">,(</span><span class="s1">&#39;Chn.&#39;</span> <span class="p">,</span><span class="s1">&#39;</span><span class="si">{:^3}</span><span class="s1">&#39;</span>  <span class="p">,</span> <span class="mi">3</span><span class="p">)],</span>
			<span class="p">[</span><span class="s1">&#39;seq&#39;</span><span class="p">,(</span><span class="s1">&#39;Seq.&#39;</span> <span class="p">,</span><span class="s1">&#39;</span><span class="si">{:^4}</span><span class="s1">&#39;</span>  <span class="p">,</span> <span class="mi">5</span><span class="p">)],</span>
			<span class="p">[</span><span class="s1">&#39;res&#39;</span><span class="p">,(</span><span class="s1">&#39;Res.&#39;</span> <span class="p">,</span><span class="s1">&#39;</span><span class="si">{:^5}</span><span class="s1">&#39;</span>  <span class="p">,</span> <span class="mi">5</span><span class="p">)],</span>
			<span class="p">[</span><span class="s1">&#39;atm&#39;</span><span class="p">,(</span><span class="s1">&#39;Atom&#39;</span> <span class="p">,</span><span class="s1">&#39;</span><span class="si">{:^4}</span><span class="s1">&#39;</span>  <span class="p">,</span> <span class="mi">5</span><span class="p">)],</span>
			<span class="p">[</span><span class="s1">&#39;cal&#39;</span><span class="p">,(</span><span class="s1">&#39;Calc.&#39;</span><span class="p">,</span><span class="s1">&#39;</span><span class="si">{:^.3f}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="mi">7</span><span class="p">)],</span>
			<span class="p">[</span><span class="s1">&#39;exp&#39;</span><span class="p">,(</span><span class="s1">&#39;Exp.&#39;</span> <span class="p">,</span><span class="s1">&#39;</span><span class="si">{:^.3f}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="mi">7</span><span class="p">)],</span>
			<span class="p">[</span><span class="s1">&#39;err&#39;</span><span class="p">,(</span><span class="s1">&#39;Err.&#39;</span> <span class="p">,</span><span class="s1">&#39;</span><span class="si">{:^.3f}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="mi">7</span><span class="p">)],</span>
			<span class="p">[</span><span class="s1">&#39;dev&#39;</span><span class="p">,(</span><span class="s1">&#39;Dev.&#39;</span> <span class="p">,</span><span class="s1">&#39;</span><span class="si">{:^.3f}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="mi">7</span><span class="p">)]</span>
		<span class="p">])</span>

		<span class="bp">self</span><span class="o">.</span><span class="n">rowReference</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">currentIndex</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">IntVar</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">currentModel</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">IntVar</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">currentIndex</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="s2">&quot;w&quot;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">idx_change</span><span class="p">)</span>

		<span class="bp">self</span><span class="o">.</span><span class="n">lbl_qfac</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">set_qfac</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">lbl_qfac</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

		<span class="n">ttk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Plot&quot;</span><span class="p">,</span> 
			<span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

		<span class="n">ttk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Save&quot;</span><span class="p">,</span> 
			<span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">save</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

		<span class="bp">self</span><span class="o">.</span><span class="n">hide_nan</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">BooleanVar</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">hide_nan</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">hide_nan_change</span><span class="p">)</span>
		<span class="n">ttk</span><span class="o">.</span><span class="n">Checkbutton</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Hide &#39;nan&#39;&quot;</span><span class="p">,</span>
			<span class="n">variable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">hide_nan</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

		<span class="bp">self</span><span class="o">.</span><span class="n">listBox</span> <span class="o">=</span> <span class="n">Treeviewer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">)</span>

		<span class="c1"># self.listBox = tk.Listbox(self, width=len(self.lblLine)+1, </span>
		<span class="c1"># 	height=25, font=(&quot;Courier&quot;, settings[&#39;listboxFontSize&#39;]))</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">listBox</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">columnspan</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">listBox</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Double-Button-1&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_position</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">listBox</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toggle_use</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">scrollBar</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Scrollbar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">VERTICAL</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">scrollBar</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;NSE&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">scrollBar</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">listBox</span><span class="o">.</span><span class="n">yview</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">listBox</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">yscrollcommand</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">scrollBar</span><span class="o">.</span><span class="n">set</span><span class="p">)</span>

		<span class="bp">self</span><span class="o">.</span><span class="n">buttonFrame</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">buttonFrame</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">columnspan</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
		<span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buttonFrame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Change models:&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">buttonR</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buttonFrame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;&lt;&#39;</span><span class="p">,</span> 
			<span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">prev_model</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="s1">&#39;disabled&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">buttonF</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buttonFrame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;&gt;&#39;</span><span class="p">,</span> 
			<span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">next_model</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="s1">&#39;disabled&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">lblModel</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buttonFrame</span><span class="p">,</span> 
			<span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">currentModel</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">buttonR</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">lblModel</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">buttonF</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

	<span class="nd">@property</span>
	<span class="k">def</span> <span class="nf">models</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="n">models</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">frm_coords</span><span class="o">.</span><span class="n">frm_pdb</span><span class="o">.</span><span class="n">models</span>
		<span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">models</span><span class="p">))</span>

	<span class="k">def</span> <span class="nf">idx_change</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
		<span class="n">idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentIndex</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
		<span class="k">if</span> <span class="n">idx</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">currentModel</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">currentModel</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>

	<span class="k">def</span> <span class="nf">set_current_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">):</span>
		<span class="n">idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">currentIndex</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>

	<span class="k">def</span> <span class="nf">draw_view</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">rowReference</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
			<span class="k">return</span>

		<span class="n">fd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
		<span class="n">curModel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentModel</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
		<span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;mdl&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">curModel</span><span class="p">]</span>

		<span class="n">dispData</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;PCS&#39;</span><span class="p">,</span><span class="s1">&#39;PRE&#39;</span><span class="p">]:</span>
			<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
				<span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;use&#39;</span><span class="p">]:</span>
					<span class="n">fd</span><span class="p">[</span><span class="s1">&#39;use&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;x&#39;</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="n">fd</span><span class="p">[</span><span class="s1">&#39;use&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span>
				<span class="n">atom</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;atm&#39;</span><span class="p">]</span>
				<span class="n">_</span><span class="p">,</span> <span class="n">mdl</span><span class="p">,</span><span class="n">fd</span><span class="p">[</span><span class="s1">&#39;chn&#39;</span><span class="p">],(</span><span class="n">_</span><span class="p">,</span><span class="n">seq</span><span class="p">,</span><span class="n">_</span><span class="p">),(</span><span class="n">fd</span><span class="p">[</span><span class="s1">&#39;atm&#39;</span><span class="p">],</span><span class="n">_</span><span class="p">)</span> <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">get_full_id</span><span class="p">()</span>
				<span class="n">fd</span><span class="p">[</span><span class="s1">&#39;seq&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span>
				<span class="n">fd</span><span class="p">[</span><span class="s1">&#39;res&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">resname</span>
				<span class="n">fd</span><span class="p">[</span><span class="s1">&#39;exp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;exp&#39;</span><span class="p">]</span>
				<span class="n">fd</span><span class="p">[</span><span class="s1">&#39;cal&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;cal&#39;</span><span class="p">]</span>
				<span class="n">fd</span><span class="p">[</span><span class="s1">&#39;err&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;err&#39;</span><span class="p">]</span>
				<span class="n">fd</span><span class="p">[</span><span class="s1">&#39;dev&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;exp&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;cal&#39;</span><span class="p">])</span>
				<span class="c1"># line = [self.fields[n][1].format(v) for n, v in fd.items()]</span>
				<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">hide_nan</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
					<span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">fd</span><span class="p">[</span><span class="s1">&#39;exp&#39;</span><span class="p">]):</span>
						<span class="k">continue</span>
				<span class="n">dispData</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fd</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">rowReference</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>

		<span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="o">==</span><span class="s1">&#39;RDC&#39;</span><span class="p">:</span>
			<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
				<span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;use&#39;</span><span class="p">]:</span>
					<span class="n">fd</span><span class="p">[</span><span class="s1">&#39;use&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;x&#39;</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="n">fd</span><span class="p">[</span><span class="s1">&#39;use&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span>
				<span class="n">atom1</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;atm&#39;</span><span class="p">]</span>
				<span class="n">atom2</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;atx&#39;</span><span class="p">]</span>
				<span class="n">_</span><span class="p">,</span> <span class="n">mdl</span><span class="p">,</span><span class="n">chn1</span><span class="p">,(</span><span class="n">_</span><span class="p">,</span><span class="n">seq1</span><span class="p">,</span><span class="n">_</span><span class="p">),(</span><span class="n">atm1</span><span class="p">,</span><span class="n">_</span><span class="p">)</span> <span class="o">=</span> <span class="n">atom1</span><span class="o">.</span><span class="n">get_full_id</span><span class="p">()</span>
				<span class="n">_</span><span class="p">,</span> <span class="n">mdl</span><span class="p">,</span><span class="n">chn2</span><span class="p">,(</span><span class="n">_</span><span class="p">,</span><span class="n">seq2</span><span class="p">,</span><span class="n">_</span><span class="p">),(</span><span class="n">atm2</span><span class="p">,</span><span class="n">_</span><span class="p">)</span> <span class="o">=</span> <span class="n">atom2</span><span class="o">.</span><span class="n">get_full_id</span><span class="p">()</span>
				<span class="n">res1</span> <span class="o">=</span> <span class="n">atom1</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">resname</span>
				<span class="n">res2</span> <span class="o">=</span> <span class="n">atom2</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">resname</span>
				<span class="n">fd</span><span class="p">[</span><span class="s1">&#39;seq&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">-</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">seq1</span><span class="p">,</span> <span class="n">seq2</span><span class="p">)</span>
				<span class="n">fd</span><span class="p">[</span><span class="s1">&#39;res&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">-</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">res1</span><span class="p">,</span> <span class="n">res2</span><span class="p">)</span>
				<span class="n">fd</span><span class="p">[</span><span class="s1">&#39;atm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">-</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">atm1</span><span class="p">,</span> <span class="n">atm2</span><span class="p">)</span>
				<span class="n">fd</span><span class="p">[</span><span class="s1">&#39;chn&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">-</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">chn1</span><span class="p">,</span> <span class="n">chn2</span><span class="p">)</span>
				<span class="n">fd</span><span class="p">[</span><span class="s1">&#39;exp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;exp&#39;</span><span class="p">]</span>
				<span class="n">fd</span><span class="p">[</span><span class="s1">&#39;cal&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;cal&#39;</span><span class="p">]</span>
				<span class="n">fd</span><span class="p">[</span><span class="s1">&#39;err&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;err&#39;</span><span class="p">]</span>
				<span class="n">fd</span><span class="p">[</span><span class="s1">&#39;dev&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;exp&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;cal&#39;</span><span class="p">])</span>
				<span class="n">dispData</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fd</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">rowReference</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>

		<span class="bp">self</span><span class="o">.</span><span class="n">listBox</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">dispData</span><span class="p">)</span>

	<span class="k">def</span> <span class="nf">set_qfac</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">lbl_qfac</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fmt_qfac</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>

	<span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="n">PlotCorrelationPopup</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span>

	<span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="n">SaveDataPopup</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

	<span class="k">def</span> <span class="nf">hide_nan_change</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">reselect</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">rescroll</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<div class="viewcode-block" id="DataView.update"><a class="viewcode-back" href="../../index.html#paramagpy.gui.DataView.update">[docs]</a>	<span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reselect</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">rescroll</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
		<span class="n">scrollPos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">listBox</span><span class="o">.</span><span class="n">yview</span><span class="p">()</span>
		<span class="n">curFocus</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">listBox</span><span class="o">.</span><span class="n">focus</span><span class="p">()</span>
		<span class="n">curSelect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">listBox</span><span class="o">.</span><span class="n">selection</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">listBox</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
		<span class="n">numModels</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">)</span>

		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">currentIndex</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
		<span class="k">elif</span> <span class="n">numModels</span> <span class="o">&lt;=</span><span class="mi">1</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">currentIndex</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">buttonR</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="s1">&#39;disabled&#39;</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">buttonF</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="s1">&#39;disabled&#39;</span><span class="p">)</span>
		<span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentIndex</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">currentIndex</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">buttonR</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="s1">&#39;disabled&#39;</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">buttonF</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="s1">&#39;active&#39;</span><span class="p">)</span>
		<span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentIndex</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="n">numModels</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">currentIndex</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">numModels</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">buttonR</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="s1">&#39;active&#39;</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">buttonF</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="s1">&#39;disabled&#39;</span><span class="p">)</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">buttonR</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="s1">&#39;active&#39;</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">buttonF</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="s1">&#39;active&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">draw_view</span><span class="p">()</span>
		<span class="k">if</span> <span class="n">rescroll</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">listBox</span><span class="o">.</span><span class="n">yview_moveto</span><span class="p">(</span><span class="n">scrollPos</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
		<span class="k">if</span> <span class="n">curSelect</span> <span class="ow">and</span> <span class="n">reselect</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">listBox</span><span class="o">.</span><span class="n">focus</span><span class="p">(</span><span class="n">curFocus</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">listBox</span><span class="o">.</span><span class="n">selection_set</span><span class="p">(</span><span class="n">curSelect</span><span class="p">)</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">listBox</span><span class="o">.</span><span class="n">last_sort</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">listBox</span><span class="o">.</span><span class="n">last_sort</span><span class="p">()</span></div>

	<span class="k">def</span> <span class="nf">next_model</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">currentIndex</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentIndex</span><span class="o">.</span><span class="n">get</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>

	<span class="k">def</span> <span class="nf">prev_model</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">currentIndex</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentIndex</span><span class="o">.</span><span class="n">get</span><span class="p">()</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>

	<span class="k">def</span> <span class="nf">set_position</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
		<span class="n">foc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">listBox</span><span class="o">.</span><span class="n">focus</span><span class="p">()</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="n">foc</span><span class="p">:</span>
			<span class="k">return</span>
		<span class="n">idx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">foc</span><span class="p">)</span>
		<span class="n">row</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rowReference</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
		<span class="n">atom</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;atm&#39;</span><span class="p">]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">tensorStart</span><span class="o">.</span><span class="n">tensor</span><span class="o">.</span><span class="n">position</span> <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">coord</span><span class="o">*</span><span class="mf">1E-10</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">tensorStart</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>

	<span class="k">def</span> <span class="nf">toggle_use</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
		<span class="n">idxs</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">listBox</span><span class="o">.</span><span class="n">selection</span><span class="p">())</span>
		<span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">idxs</span><span class="p">:</span>
			<span class="n">row</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rowReference</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
			<span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;exp&#39;</span><span class="p">]):</span>
				<span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">data</span>
				<span class="n">data</span><span class="p">[</span><span class="s1">&#39;use&#39;</span><span class="p">][</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;idx&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;idx&#39;</span><span class="p">])]</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;use&#39;</span><span class="p">]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span></div>


<div class="viewcode-block" id="TensorFrame"><a class="viewcode-back" href="../../index.html#paramagpy.gui.TensorFrame">[docs]</a><span class="k">class</span> <span class="nc">TensorFrame</span><span class="p">(</span><span class="n">tk</span><span class="o">.</span><span class="n">LabelFrame</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	The initial tensor fields </span>
<span class="sd">	&quot;&quot;&quot;</span>
	<span class="n">tensorVariables</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">([</span>
		<span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;x/</span><span class="se">\u00c5</span><span class="s1">&#39;</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="s1">&#39;y/</span><span class="se">\u00c5</span><span class="s1">&#39;</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">,</span><span class="s1">&#39;z/</span><span class="se">\u00c5</span><span class="s1">&#39;</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;</span><span class="se">\u03b1</span><span class="s1">/</span><span class="se">\u00b0</span><span class="s1">&#39;</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;</span><span class="se">\u03b2</span><span class="s1">/</span><span class="se">\u00b0</span><span class="s1">&#39;</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">,</span><span class="s1">&#39;</span><span class="se">\u03b3</span><span class="s1">/</span><span class="se">\u00b0</span><span class="s1">&#39;</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">&#39;ax&#39;</span><span class="p">,</span><span class="s1">&#39;</span><span class="se">\u0394\u03c7</span><span class="s1">ax/10</span><span class="se">\u207b\u00b3\u00b2</span><span class="s1">&#39;</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">&#39;rh&#39;</span><span class="p">,</span><span class="s1">&#39;</span><span class="se">\u0394\u03c7</span><span class="s1">rh/10</span><span class="se">\u207b\u00b3\u00b2</span><span class="s1">&#39;</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">&#39;iso&#39;</span><span class="p">,</span><span class="s1">&#39;</span><span class="se">\u03c7</span><span class="s1">iso/10</span><span class="se">\u207b\u00b3\u00b2</span><span class="s1">&#39;</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">&#39;ref&#39;</span><span class="p">,</span><span class="s1">&#39;ref./ppm&#39;</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">&#39;taur&#39;</span><span class="p">,</span><span class="s1">&#39;</span><span class="se">\u03c4</span><span class="s1">r/ns&#39;</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">&#39;t1e&#39;</span><span class="p">,</span><span class="s1">&#39;T1e/ps&#39;</span><span class="p">)])</span>

	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
		<span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">text</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span> <span class="c1"># DataTab</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">dtype</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">dtype</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">fields</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">tensor</span> <span class="o">=</span> <span class="n">metal</span><span class="o">.</span><span class="n">Metal</span><span class="p">()</span>

		<span class="k">if</span> <span class="s1">&#39;Initial&#39;</span> <span class="ow">in</span> <span class="n">text</span><span class="p">:</span>
			<span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Lanthanide Template:&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
				<span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">columnspan</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">templateVar</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s2">&quot;Zero&quot;</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">templateVar</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">template_change</span><span class="p">)</span>
			<span class="n">lanths</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">metal</span><span class="o">.</span><span class="n">Metal</span><span class="o">.</span><span class="n">lanth_lib</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
			<span class="n">ttk</span><span class="o">.</span><span class="n">Combobox</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">templateVar</span><span class="p">,</span>
				<span class="n">values</span><span class="o">=</span><span class="n">lanths</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> 
				<span class="n">state</span><span class="o">=</span><span class="s2">&quot;readonly&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">columnspan</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

		<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="p">]):</span>
			<span class="k">def</span> <span class="nf">wrap</span><span class="p">(</span><span class="n">axis</span><span class="p">):</span>
				<span class="n">ax</span> <span class="o">=</span> <span class="n">axis</span>
				<span class="k">def</span> <span class="nf">parse</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">tensor</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="o">*</span><span class="mf">1E-10</span>
				<span class="k">def</span> <span class="nf">disp</span><span class="p">():</span>
					<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tensor</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">*</span><span class="mf">1E10</span>
				<span class="k">return</span> <span class="n">parse</span><span class="p">,</span> <span class="n">disp</span>
			<span class="n">parse</span><span class="p">,</span> <span class="n">disp</span> <span class="o">=</span> <span class="n">wrap</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">NumericEntry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parse</span><span class="p">,</span> <span class="n">disp</span><span class="p">)</span>

		<span class="k">def</span> <span class="nf">parse</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">tensor</span><span class="o">.</span><span class="n">taur</span> <span class="o">=</span> <span class="n">value</span><span class="o">*</span><span class="mf">1E-9</span>
		<span class="k">def</span> <span class="nf">disp</span><span class="p">():</span>
			<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tensor</span><span class="o">.</span><span class="n">taur</span><span class="o">*</span><span class="mf">1E9</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="s1">&#39;taur&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">NumericEntry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parse</span><span class="p">,</span> <span class="n">disp</span><span class="p">,</span> <span class="n">onlyPositive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

		<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;g&#39;</span><span class="p">]):</span>
			<span class="k">def</span> <span class="nf">wrap</span><span class="p">(</span><span class="n">axis</span><span class="p">):</span>
				<span class="n">ax</span> <span class="o">=</span> <span class="n">axis</span>
				<span class="k">def</span> <span class="nf">parse</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">tensor</span><span class="o">.</span><span class="n">eulers</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">180.</span><span class="p">)</span>
				<span class="k">def</span> <span class="nf">disp</span><span class="p">():</span>
					<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tensor</span><span class="o">.</span><span class="n">eulers</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="mf">180.</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
				<span class="k">return</span> <span class="n">parse</span><span class="p">,</span> <span class="n">disp</span>
			<span class="n">parse</span><span class="p">,</span> <span class="n">disp</span> <span class="o">=</span> <span class="n">wrap</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">NumericEntry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parse</span><span class="p">,</span> <span class="n">disp</span><span class="p">)</span>

		<span class="k">def</span> <span class="nf">parse</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">tensor</span><span class="o">.</span><span class="n">t1e</span> <span class="o">=</span> <span class="n">value</span><span class="o">*</span><span class="mf">1E-13</span>
		<span class="k">def</span> <span class="nf">disp</span><span class="p">():</span>
			<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tensor</span><span class="o">.</span><span class="n">t1e</span><span class="o">*</span><span class="mf">1E13</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="s1">&#39;t1e&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">NumericEntry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parse</span><span class="p">,</span> <span class="n">disp</span><span class="p">,</span> <span class="n">onlyPositive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

		<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="s1">&#39;ax&#39;</span><span class="p">,</span><span class="s1">&#39;rh&#39;</span><span class="p">]):</span>
			<span class="k">def</span> <span class="nf">wrap</span><span class="p">(</span><span class="n">axis</span><span class="p">):</span>
				<span class="n">ax</span> <span class="o">=</span> <span class="n">axis</span>
				<span class="k">def</span> <span class="nf">parse</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">tensor</span><span class="o">.</span><span class="n">axrh</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="o">*</span><span class="mf">1E-32</span>
				<span class="k">def</span> <span class="nf">disp</span><span class="p">():</span>
					<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tensor</span><span class="o">.</span><span class="n">axrh</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">*</span><span class="mf">1E32</span>
				<span class="k">return</span> <span class="n">parse</span><span class="p">,</span> <span class="n">disp</span>
			<span class="n">parse</span><span class="p">,</span> <span class="n">disp</span> <span class="o">=</span> <span class="n">wrap</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">NumericEntry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parse</span><span class="p">,</span> <span class="n">disp</span><span class="p">)</span>

		<span class="k">def</span> <span class="nf">parse</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">tensor</span><span class="o">.</span><span class="n">isotropy</span> <span class="o">=</span> <span class="n">value</span><span class="o">*</span><span class="mf">1E-32</span>
		<span class="k">def</span> <span class="nf">disp</span><span class="p">():</span>
			<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tensor</span><span class="o">.</span><span class="n">isotropy</span><span class="o">*</span><span class="mf">1E32</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="s1">&#39;iso&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">NumericEntry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parse</span><span class="p">,</span> <span class="n">disp</span><span class="p">,</span> <span class="n">onlyPositive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

		<span class="k">def</span> <span class="nf">parse</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">tensor</span><span class="o">.</span><span class="n">shift</span> <span class="o">=</span> <span class="n">value</span>
		<span class="k">def</span> <span class="nf">disp</span><span class="p">():</span>
			<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tensor</span><span class="o">.</span><span class="n">shift</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="s1">&#39;ref&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">NumericEntry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parse</span><span class="p">,</span> <span class="n">disp</span><span class="p">)</span>

		<span class="n">i</span><span class="o">=</span><span class="mi">0</span>
		<span class="n">ofs</span> <span class="o">=</span> <span class="mi">1</span>
		<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">field</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
			<span class="n">label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tensorVariables</span><span class="p">[</span><span class="n">name</span><span class="p">])</span>
			<span class="n">label</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">ofs</span><span class="o">+</span><span class="n">i</span><span class="o">%</span><span class="mi">4</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="p">(</span><span class="n">i</span><span class="o">//</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span>
			<span class="n">field</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">ofs</span><span class="o">+</span><span class="n">i</span><span class="o">%</span><span class="mi">4</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="p">(</span><span class="n">i</span><span class="o">//</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
			<span class="n">i</span><span class="o">+=</span><span class="mi">1</span>
			<span class="n">field</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">label</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span>

		<span class="n">ttk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Copy&#39;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">4</span><span class="o">+</span><span class="n">ofs</span><span class="p">,</span> 
			<span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">columnspan</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;EW&#39;</span><span class="p">)</span>
		<span class="n">ttk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Paste&#39;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">paste</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">4</span><span class="o">+</span><span class="n">ofs</span><span class="p">,</span> 
			<span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">columnspan</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;EW&#39;</span><span class="p">)</span>
		<span class="n">ttk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Plot&#39;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">4</span><span class="o">+</span><span class="n">ofs</span><span class="p">,</span> 
			<span class="n">column</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">columnspan</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;EW&#39;</span><span class="p">)</span>

		<span class="k">if</span> <span class="s1">&#39;Fitted&#39;</span> <span class="ow">in</span> <span class="n">text</span><span class="p">:</span>
			<span class="n">ttk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Error Sim.&#39;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">error_sim</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">5</span><span class="o">+</span><span class="n">ofs</span><span class="p">,</span> 
				<span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">columnspan</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;EW&#39;</span><span class="p">)</span>
			<span class="n">ttk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Set UTR&#39;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">set_utr</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">5</span><span class="o">+</span><span class="n">ofs</span><span class="p">,</span> 
				<span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">columnspan</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;EW&#39;</span><span class="p">)</span>
			<span class="n">ttk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;More&#39;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">more</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">5</span><span class="o">+</span><span class="n">ofs</span><span class="p">,</span> 
				<span class="n">column</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">columnspan</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;EW&#39;</span><span class="p">)</span>

		<span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>

	<span class="nd">@property</span>
	<span class="k">def</span> <span class="nf">fopts</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">frm_fopts</span>

	<span class="k">def</span> <span class="nf">template_change</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
		<span class="n">lanth</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">templateVar</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="o">==</span><span class="s1">&#39;PRE&#39;</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">tensor</span><span class="o">.</span><span class="n">set_lanthanide</span><span class="p">(</span><span class="n">lanth</span><span class="p">,</span> <span class="n">set_dchi</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">tensor</span><span class="o">.</span><span class="n">set_lanthanide</span><span class="p">(</span><span class="n">lanth</span><span class="p">,</span> <span class="n">set_dchi</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>

<div class="viewcode-block" id="TensorFrame.update"><a class="viewcode-back" href="../../index.html#paramagpy.gui.TensorFrame.update">[docs]</a>	<span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
			<span class="n">field</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>

		<span class="n">pcs_fields</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;g&#39;</span><span class="p">,</span><span class="s1">&#39;ax&#39;</span><span class="p">,</span><span class="s1">&#39;rh&#39;</span><span class="p">,</span><span class="s1">&#39;ref&#39;</span><span class="p">])</span>
		<span class="n">rdc_fields</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;g&#39;</span><span class="p">,</span><span class="s1">&#39;ax&#39;</span><span class="p">,</span><span class="s1">&#39;rh&#39;</span><span class="p">])</span>
		<span class="n">pre_fields</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;g&#39;</span><span class="p">,</span><span class="s1">&#39;ax&#39;</span><span class="p">,</span><span class="s1">&#39;rh&#39;</span><span class="p">,</span><span class="s1">&#39;iso&#39;</span><span class="p">,</span><span class="s1">&#39;taur&#39;</span><span class="p">,</span><span class="s1">&#39;t1e&#39;</span><span class="p">])</span>

		<span class="n">fpars</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fopts</span><span class="o">.</span><span class="n">params</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="o">==</span><span class="s1">&#39;PCS&#39;</span><span class="p">:</span>
			<span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">:</span>
				<span class="n">field</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">var</span><span class="p">]</span>
				<span class="k">if</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">pcs_fields</span><span class="p">:</span>
					<span class="n">field</span><span class="o">.</span><span class="n">enable</span><span class="p">()</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="n">field</span><span class="o">.</span><span class="n">disable</span><span class="p">()</span>

			<span class="k">if</span> <span class="n">fpars</span><span class="p">[</span><span class="s1">&#39;ref&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="s1">&#39;ref&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">fg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="s1">&#39;ref&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">fg</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>

			<span class="k">if</span> <span class="n">fpars</span><span class="p">[</span><span class="s1">&#39;pos&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
				<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="p">]:</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">fg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="p">]:</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">fg</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>

		<span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="o">==</span><span class="s1">&#39;RDC&#39;</span><span class="p">:</span>
			<span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">:</span>
				<span class="n">field</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">var</span><span class="p">]</span>
				<span class="k">if</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">rdc_fields</span><span class="p">:</span>
					<span class="n">field</span><span class="o">.</span><span class="n">enable</span><span class="p">()</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="n">field</span><span class="o">.</span><span class="n">disable</span><span class="p">()</span>

		<span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="o">==</span><span class="s1">&#39;PRE&#39;</span><span class="p">:</span>
			<span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">:</span>
				<span class="n">field</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">var</span><span class="p">]</span>
				<span class="k">if</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">pre_fields</span><span class="p">:</span>
					<span class="n">field</span><span class="o">.</span><span class="n">enable</span><span class="p">()</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="n">field</span><span class="o">.</span><span class="n">disable</span><span class="p">()</span>

			<span class="k">if</span> <span class="n">fpars</span><span class="p">[</span><span class="s1">&#39;pos&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
				<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="p">]:</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">fg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="p">]:</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">fg</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>

			<span class="k">if</span> <span class="n">fpars</span><span class="p">[</span><span class="s1">&#39;dchi&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
				<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;ax&#39;</span><span class="p">,</span><span class="s1">&#39;rh&#39;</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;g&#39;</span><span class="p">]:</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">fg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;ax&#39;</span><span class="p">,</span><span class="s1">&#39;rh&#39;</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;g&#39;</span><span class="p">]:</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">fg</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>

			<span class="k">if</span> <span class="n">fpars</span><span class="p">[</span><span class="s1">&#39;taur&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="s1">&#39;taur&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">fg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="s1">&#39;taur&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">fg</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>

			<span class="k">if</span> <span class="n">fpars</span><span class="p">[</span><span class="s1">&#39;taue&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="s1">&#39;t1e&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">fg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="s1">&#39;t1e&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">fg</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>

			<span class="k">if</span> <span class="n">fpars</span><span class="p">[</span><span class="s1">&#39;iso&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="s1">&#39;iso&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">fg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="s1">&#39;iso&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">fg</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span></div>

	<span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">clipboard_clear</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">clipboard_append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tensor</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">comment</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">copied_tensor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tensor</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

	<span class="k">def</span> <span class="nf">paste</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="n">copied_tensor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">copied_tensor</span>
		<span class="k">if</span> <span class="n">copied_tensor</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">tensor</span> <span class="o">=</span> <span class="n">copied_tensor</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>

	<span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="n">PlotTensorPopup</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

	<span class="k">def</span> <span class="nf">error_sim</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="n">ErrorSimulationPopup</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

	<span class="k">def</span> <span class="nf">set_utr</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">tensor</span><span class="o">.</span><span class="n">set_utr</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>

	<span class="k">def</span> <span class="nf">more</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="n">MorePopup</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>


<div class="viewcode-block" id="DataTab"><a class="viewcode-back" href="../../index.html#paramagpy.gui.DataTab">[docs]</a><span class="k">class</span> <span class="nc">DataTab</span><span class="p">(</span><span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	A tab of the DataNotebook</span>
<span class="sd">	contains data loading, viewing and tensor info</span>
<span class="sd">	dataView : spreadsheet of data</span>
<span class="sd">	&quot;&quot;&quot;</span>
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
		<span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span> <span class="c1"># DataNotebook</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">dtype</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">dtype</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="kc">None</span>

		<span class="bp">self</span><span class="o">.</span><span class="n">tensorStart</span> <span class="o">=</span> <span class="n">TensorFrame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;Initial Tensor&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">tensorFit</span> <span class="o">=</span> <span class="n">TensorFrame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;Fitted Tensor&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">loadData</span> <span class="o">=</span> <span class="n">DataLoad</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">viewData</span> <span class="o">=</span> <span class="n">DataView</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

		<span class="bp">self</span><span class="o">.</span><span class="n">viewData</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">rowspan</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;NS&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">loadData</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;EW&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">tensorStart</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">tensorFit</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

		<span class="n">ttk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\u2193</span><span class="s2">  Fit Tensor  </span><span class="se">\u2193</span><span class="s2">&quot;</span><span class="p">,</span> 
			<span class="n">command</span><span class="o">=</span> <span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fopts</span><span class="o">.</span><span class="n">single_calc</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
			<span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;EW&#39;</span><span class="p">)</span>

		<span class="n">ttk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Back-calculate </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">),</span>
			<span class="n">command</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">back_calc</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;EW&#39;</span><span class="p">)</span>

		<span class="c1"># A check button for keeping track of available data:</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">hasData</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">IntVar</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
		
	<span class="k">def</span> <span class="nf">is_current</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">==</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">current_tab</span><span class="p">:</span>
			<span class="k">return</span> <span class="kc">True</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="k">return</span> <span class="kc">False</span>

	<span class="k">def</span> <span class="nf">rtype</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">loadData</span><span class="o">.</span><span class="n">rtype</span><span class="p">()</span>

<div class="viewcode-block" id="DataTab.update"><a class="viewcode-back" href="../../index.html#paramagpy.gui.DataTab.update">[docs]</a>	<span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">strength</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">loadData</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">hasData</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">hasData</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">tensorStart</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">tensorFit</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
		<span class="k">if</span> <span class="n">strength</span><span class="o">&gt;=</span><span class="mi">2</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">parse_data</span><span class="p">()</span>
		<span class="k">if</span> <span class="n">strength</span><span class="o">&gt;=</span><span class="mi">1</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_current</span><span class="p">():</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">viewData</span><span class="o">.</span><span class="n">update</span><span class="p">()</span></div>
		
	<span class="nd">@property</span>
	<span class="k">def</span> <span class="nf">frm_pdb</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">frm_coords</span><span class="o">.</span><span class="n">frm_pdb</span>

	<span class="nd">@property</span>
	<span class="k">def</span> <span class="nf">fopts</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">frm_fopts</span>

	<span class="nd">@property</span>
	<span class="k">def</span> <span class="nf">fmul</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">frm_fmul</span>

	<span class="k">def</span> <span class="nf">parse_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">templates</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">]</span>
		<span class="n">atom_selection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">frm_pdb</span><span class="o">.</span><span class="n">atom_selection</span>
		<span class="n">resi_selection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">frm_pdb</span><span class="o">.</span><span class="n">resi_selection</span>
		<span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="k">return</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;PCS&#39;</span><span class="p">,</span><span class="s1">&#39;PRE&#39;</span><span class="p">]:</span>
			<span class="n">expdata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loadData</span><span class="o">.</span><span class="n">data</span>
			<span class="n">usedKeys</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([])</span>
			<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
				<span class="n">atom</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;atm&#39;</span><span class="p">]</span>
				<span class="n">_</span><span class="p">,</span> <span class="n">mdl</span><span class="p">,</span> <span class="n">chn</span><span class="p">,</span> <span class="p">(</span><span class="n">_</span><span class="p">,</span><span class="n">seq</span><span class="p">,</span><span class="n">_</span><span class="p">),</span> <span class="p">(</span><span class="n">atm</span><span class="p">,</span> <span class="n">_</span><span class="p">)</span> <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">get_full_id</span><span class="p">()</span>
				<span class="n">res</span> <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">resname</span>
				<span class="n">key</span> <span class="o">=</span> <span class="n">seq</span><span class="p">,</span> <span class="n">atm</span>
				<span class="n">exp</span><span class="p">,</span> <span class="n">err</span> <span class="o">=</span> <span class="n">expdata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
				<span class="k">if</span> <span class="n">exp</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
					<span class="n">usedKeys</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
					<span class="n">row</span><span class="p">[</span><span class="s1">&#39;exp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">exp</span>
					<span class="n">row</span><span class="p">[</span><span class="s1">&#39;err&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">err</span>
					<span class="k">if</span> <span class="n">atom</span><span class="o">.</span><span class="n">element</span> <span class="ow">in</span> <span class="n">atom_selection</span> <span class="ow">and</span> <span class="n">res</span> <span class="ow">in</span> <span class="n">resi_selection</span><span class="p">:</span>
						<span class="n">row</span><span class="p">[</span><span class="s1">&#39;use&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

			<span class="n">unused</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">loadData</span><span class="o">.</span><span class="n">data</span><span class="p">)</span> <span class="o">-</span> <span class="n">usedKeys</span>
			<span class="k">if</span> <span class="n">unused</span><span class="p">:</span>
				<span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;WARNING: Some atoms were not found in the PDB:</span><span class="si">{}</span><span class="s2">&quot;</span>
				<span class="nb">print</span><span class="p">(</span><span class="n">message</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">unused</span><span class="p">))</span>

		<span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="o">==</span><span class="s1">&#39;RDC&#39;</span><span class="p">:</span>
			<span class="n">dtype</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">structdtype</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">]</span>
			<span class="n">expdata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loadData</span><span class="o">.</span><span class="n">data</span>
			<span class="k">if</span> <span class="ow">not</span> <span class="n">expdata</span><span class="p">:</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
				<span class="k">return</span>
			<span class="n">pdata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">frm_pdb</span><span class="o">.</span><span class="n">prot</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">expdata</span><span class="p">)</span>
			<span class="n">df</span> <span class="o">=</span> <span class="p">[]</span>
			<span class="k">for</span> <span class="n">atom1</span><span class="p">,</span> <span class="n">atom2</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">err</span> <span class="ow">in</span> <span class="n">pdata</span><span class="p">:</span>
				<span class="n">_</span><span class="p">,</span> <span class="n">mdl1</span><span class="p">,</span> <span class="n">chn1</span><span class="p">,</span> <span class="p">(</span><span class="n">_</span><span class="p">,</span><span class="n">seq1</span><span class="p">,</span><span class="n">_</span><span class="p">),</span> <span class="p">(</span><span class="n">atm1</span><span class="p">,</span> <span class="n">_</span><span class="p">)</span> <span class="o">=</span> <span class="n">atom1</span><span class="o">.</span><span class="n">get_full_id</span><span class="p">()</span>
				<span class="n">_</span><span class="p">,</span> <span class="n">mdl2</span><span class="p">,</span> <span class="n">chn2</span><span class="p">,</span> <span class="p">(</span><span class="n">_</span><span class="p">,</span><span class="n">seq2</span><span class="p">,</span><span class="n">_</span><span class="p">),</span> <span class="p">(</span><span class="n">atm2</span><span class="p">,</span> <span class="n">_</span><span class="p">)</span> <span class="o">=</span> <span class="n">atom2</span><span class="o">.</span><span class="n">get_full_id</span><span class="p">()</span>
				<span class="n">res1</span> <span class="o">=</span> <span class="n">atom1</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">resname</span>
				<span class="n">res2</span> <span class="o">=</span> <span class="n">atom2</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">resname</span>
				<span class="k">assert</span> <span class="n">mdl1</span><span class="o">==</span><span class="n">mdl2</span>
				<span class="n">idx</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">unique_pairing</span><span class="p">(</span><span class="n">atom1</span><span class="o">.</span><span class="n">serial_number</span><span class="p">,</span> <span class="n">atom2</span><span class="o">.</span><span class="n">serial_number</span><span class="p">)</span>
				<span class="n">row</span> <span class="o">=</span> <span class="p">(</span><span class="n">mdl1</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="n">atom1</span><span class="p">,</span> <span class="n">atom2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">err</span><span class="p">,</span> <span class="n">idx</span><span class="p">)</span>

				<span class="k">if</span> <span class="n">atom1</span><span class="o">.</span><span class="n">element</span> <span class="ow">in</span> <span class="n">atom_selection</span> <span class="ow">and</span> <span class="n">res1</span> <span class="ow">in</span> <span class="n">resi_selection</span><span class="p">:</span>
					<span class="k">if</span> <span class="n">atom2</span><span class="o">.</span><span class="n">element</span> <span class="ow">in</span> <span class="n">atom_selection</span> <span class="ow">and</span> <span class="n">res2</span> <span class="ow">in</span> <span class="n">resi_selection</span><span class="p">:</span>
						<span class="n">df</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>

	<span class="k">def</span> <span class="nf">get_fit_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
		<span class="n">filt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;use&#39;</span><span class="p">]]</span>
		<span class="k">if</span> <span class="n">model</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
			<span class="n">filt</span> <span class="o">=</span> <span class="n">filt</span><span class="p">[</span><span class="n">filt</span><span class="p">[</span><span class="s1">&#39;mdl&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">model</span><span class="p">]</span>
		<span class="k">return</span> <span class="n">filt</span>

	<span class="k">def</span> <span class="nf">back_calc</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="o">==</span><span class="s1">&#39;PCS&#39;</span><span class="p">:</span>
			<span class="n">poss</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">atom</span><span class="o">.</span><span class="n">coord</span> <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;atm&#39;</span><span class="p">]])</span><span class="o">*</span><span class="mf">1E-10</span>
			<span class="n">pcss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tensorFit</span><span class="o">.</span><span class="n">tensor</span><span class="o">.</span><span class="n">fast_pcs</span><span class="p">(</span><span class="n">poss</span><span class="p">)</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fopts</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;racs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
				<span class="n">csas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">atom</span><span class="o">.</span><span class="n">csa</span> <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;atm&#39;</span><span class="p">]])</span>
				<span class="n">racs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tensorFit</span><span class="o">.</span><span class="n">tensor</span><span class="o">.</span><span class="n">fast_racs</span><span class="p">(</span><span class="n">csas</span><span class="p">)</span>
				<span class="n">pcss</span> <span class="o">+=</span> <span class="n">racs</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fopts</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;rads&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
				<span class="n">rads</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tensorFit</span><span class="o">.</span><span class="n">tensor</span><span class="o">.</span><span class="n">fast_rads</span><span class="p">(</span><span class="n">poss</span><span class="p">)</span>
				<span class="n">pcss</span> <span class="o">+=</span> <span class="n">rads</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;cal&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pcss</span>

		<span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="o">==</span><span class="s1">&#39;RDC&#39;</span><span class="p">:</span>
			<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
				<span class="n">vec</span> <span class="o">=</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;atx&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">coord</span> <span class="o">-</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;atm&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">coord</span><span class="p">)</span><span class="o">*</span><span class="mf">1E-10</span>
				<span class="n">gam1</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;atm&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">gamma</span>
				<span class="n">gam2</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;atx&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">gamma</span>
				<span class="n">row</span><span class="p">[</span><span class="s1">&#39;cal&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tensorFit</span><span class="o">.</span><span class="n">tensor</span><span class="o">.</span><span class="n">rdc</span><span class="p">(</span><span class="n">vec</span><span class="p">,</span> <span class="n">gam1</span><span class="p">,</span> <span class="n">gam2</span><span class="p">)</span>

		<span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="o">==</span><span class="s1">&#39;PRE&#39;</span><span class="p">:</span>
			<span class="n">poss</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">atom</span><span class="o">.</span><span class="n">coord</span> <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;atm&#39;</span><span class="p">]])</span><span class="o">*</span><span class="mf">1E-10</span>
			<span class="n">gamm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">atom</span><span class="o">.</span><span class="n">gamma</span> <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;atm&#39;</span><span class="p">]])</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fopts</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;csa&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">():</span> 
				<span class="n">csas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">atom</span><span class="o">.</span><span class="n">csa</span> <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;atm&#39;</span><span class="p">]])</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">csas</span> <span class="o">=</span> <span class="mf">0.0</span>
			<span class="n">pres</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tensorFit</span><span class="o">.</span><span class="n">tensor</span><span class="o">.</span><span class="n">fast_pre</span><span class="p">(</span><span class="n">poss</span><span class="p">,</span> <span class="n">gamm</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rtype</span><span class="p">(),</span> 
				<span class="n">dsa</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fopts</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;dsa&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span> 
				<span class="n">sbm</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fopts</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;sbm&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span> <span class="n">csaarray</span><span class="o">=</span><span class="n">csas</span><span class="p">)</span>

			<span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;cal&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pres</span>


		<span class="bp">self</span><span class="o">.</span><span class="n">set_qfactor</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

	<span class="k">def</span> <span class="nf">set_qfactor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
		<span class="n">sqfac</span> <span class="o">=</span> <span class="mf">0.0</span>
		<span class="n">filt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;use&#39;</span><span class="p">]]</span>
		<span class="k">if</span> <span class="n">model</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
			<span class="n">filt</span> <span class="o">=</span> <span class="n">filt</span><span class="p">[</span><span class="n">filt</span><span class="p">[</span><span class="s1">&#39;mdl&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">model</span><span class="p">]</span>
		<span class="n">qnumer</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">filt</span><span class="p">[</span><span class="s1">&#39;exp&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">filt</span><span class="p">[</span><span class="s1">&#39;cal&#39;</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
		<span class="n">qdenom</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">filt</span><span class="p">[</span><span class="s1">&#39;exp&#39;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
		<span class="n">sqfac</span> <span class="o">+=</span> <span class="p">(</span><span class="n">qnumer</span><span class="o">/</span><span class="n">qdenom</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>
		<span class="n">qfac</span> <span class="o">=</span> <span class="n">sqfac</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">viewData</span><span class="o">.</span><span class="n">set_qfac</span><span class="p">(</span><span class="n">qfac</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">qfac</span>

	<span class="k">def</span> <span class="nf">get_model_average</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="n">model</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frm_pdb</span><span class="o">.</span><span class="n">models</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
		<span class="n">new</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;mdl&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">model</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
		<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">new</span><span class="p">:</span>
			<span class="n">calcs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;cal&#39;</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;idx&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;idx&#39;</span><span class="p">]]</span>
			<span class="n">row</span><span class="p">[</span><span class="s1">&#39;mdl&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
			<span class="n">row</span><span class="p">[</span><span class="s1">&#39;cal&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">calcs</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">calcs</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">new</span></div>


<div class="viewcode-block" id="ColourSampler"><a class="viewcode-back" href="../../index.html#paramagpy.gui.ColourSampler">[docs]</a><span class="k">class</span> <span class="nc">ColourSampler</span><span class="p">(</span><span class="n">tk</span><span class="o">.</span><span class="n">Canvas</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;docstring for ColourSampler&quot;&quot;&quot;</span>
	<span class="n">class_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;#0000ff&#39;</span><span class="p">,</span><span class="s1">&#39;#ff0000&#39;</span><span class="p">,</span><span class="s1">&#39;#00ff00&#39;</span><span class="p">,</span><span class="s1">&#39;#bbbb00&#39;</span><span class="p">,</span><span class="s1">&#39;#00bbbb&#39;</span><span class="p">]</span>
	<span class="n">class_iter</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>

	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">defaultColour</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
		<span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="n">defaultColour</span><span class="p">:</span>
			<span class="n">defaultColour</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">class_cols</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">class_iter</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">class_iter</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">class_iter</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="mi">5</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">colour</span> <span class="o">=</span> <span class="n">defaultColour</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-1&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">change_colour</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">box</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_rectangle</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">colour</span><span class="p">)</span>

	<span class="k">def</span> <span class="nf">change_colour</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
		<span class="n">rgb</span><span class="p">,</span> <span class="n">hexi</span> <span class="o">=</span> <span class="n">askcolor</span><span class="p">(</span><span class="n">initialcolor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">colour</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">hexi</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">colour</span> <span class="o">=</span> <span class="n">hexi</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">itemconfig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">box</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">hexi</span><span class="p">)</span></div>


<div class="viewcode-block" id="MultipleFitFrame"><a class="viewcode-back" href="../../index.html#paramagpy.gui.MultipleFitFrame">[docs]</a><span class="k">class</span> <span class="nc">MultipleFitFrame</span><span class="p">(</span><span class="n">tk</span><span class="o">.</span><span class="n">LabelFrame</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;Multiple fit PCS frame&quot;&quot;&quot;</span>
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="s1">&#39;fitting&#39;</span><span class="p">,</span> <span class="n">root</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="n">root</span><span class="p">:</span>
			<span class="n">root</span> <span class="o">=</span> <span class="n">parent</span>
		<span class="k">if</span> <span class="n">state</span><span class="o">==</span><span class="s1">&#39;fitting&#39;</span><span class="p">:</span>
			<span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;Multiple Fit </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">parent</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
		<span class="k">elif</span> <span class="n">state</span><span class="o">==</span><span class="s1">&#39;plotting&#39;</span><span class="p">:</span>
			<span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;Plot multiple </span><span class="si">{}</span><span class="s2"> data&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">parent</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>

		<span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span> <span class="c1"># MethodsTab</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">dtype</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">dtype</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">params</span> <span class="o">=</span> <span class="p">[]</span>

		<span class="k">if</span> <span class="n">state</span><span class="o">==</span><span class="s1">&#39;fitting&#39;</span><span class="p">:</span>
			<span class="n">num_dtabs</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">ntb_data</span><span class="o">.</span><span class="n">tabs</span><span class="p">)</span>
			<span class="n">ttk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Multiple Fit Tensor&quot;</span><span class="p">,</span> 
				<span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">multiple_calc</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">columnspan</span><span class="o">=</span><span class="n">num_dtabs</span><span class="p">)</span>
		<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">tab</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">ntb_data</span><span class="o">.</span><span class="n">tabs</span><span class="p">):</span>
			<span class="n">useMulti</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">IntVar</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
			<span class="k">if</span> <span class="n">state</span><span class="o">==</span><span class="s1">&#39;plotting&#39;</span> <span class="ow">and</span> <span class="n">tab</span><span class="o">.</span><span class="n">is_current</span><span class="p">()</span> <span class="ow">and</span> <span class="n">tab</span><span class="o">.</span><span class="n">hasData</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
				<span class="n">useMulti</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
			<span class="n">chk</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Checkbutton</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">tab</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> 
				<span class="n">variable</span><span class="o">=</span><span class="n">useMulti</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="s1">&#39;disabled&#39;</span><span class="p">)</span>
			<span class="n">chk</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
			<span class="n">chk</span><span class="o">.</span><span class="n">traceID</span> <span class="o">=</span> <span class="n">tab</span><span class="o">.</span><span class="n">hasData</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_data_change</span><span class="p">)</span>
			<span class="k">if</span> <span class="n">state</span><span class="o">==</span><span class="s1">&#39;plotting&#39;</span><span class="p">:</span>
				<span class="n">tab</span><span class="o">.</span><span class="n">colour</span> <span class="o">=</span> <span class="n">ColourSampler</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
				<span class="n">tab</span><span class="o">.</span><span class="n">colour</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>

			<span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">tab</span><span class="p">,</span> <span class="n">chk</span><span class="p">,</span> <span class="n">useMulti</span><span class="p">))</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>

	<span class="nd">@property</span>
	<span class="k">def</span> <span class="nf">fopts</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">frm_fopts</span>

	<span class="k">def</span> <span class="nf">has_data_change</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
		<span class="k">for</span> <span class="n">tab</span><span class="p">,</span> <span class="n">chk</span><span class="p">,</span> <span class="n">var</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">:</span>
			<span class="k">if</span> <span class="n">tab</span><span class="o">.</span><span class="n">hasData</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
				<span class="n">var</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<div class="viewcode-block" id="MultipleFitFrame.update"><a class="viewcode-back" href="../../index.html#paramagpy.gui.MultipleFitFrame.update">[docs]</a>	<span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
		<span class="k">for</span> <span class="n">tab</span><span class="p">,</span> <span class="n">chk</span><span class="p">,</span> <span class="n">var</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">:</span>
			<span class="k">if</span> <span class="n">tab</span><span class="o">.</span><span class="n">hasData</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
				<span class="n">chk</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="s1">&#39;normal&#39;</span><span class="p">)</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">chk</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="s1">&#39;disabled&#39;</span><span class="p">)</span></div>

	<span class="k">def</span> <span class="nf">get_chosen_tabs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="n">tabs</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">for</span> <span class="n">tab</span><span class="p">,</span> <span class="n">chk</span><span class="p">,</span> <span class="n">var</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">:</span>
			<span class="k">if</span> <span class="n">var</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
				<span class="n">tabs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tab</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">tabs</span>

	<span class="k">def</span> <span class="nf">multiple_calc</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="n">tabs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_chosen_tabs</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">fopts</span><span class="o">.</span><span class="n">multiple_calc</span><span class="p">(</span><span class="n">tabs</span><span class="p">)</span>

	<span class="k">def</span> <span class="nf">remove_traces</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">for</span> <span class="n">tab</span><span class="p">,</span> <span class="n">chk</span><span class="p">,</span> <span class="n">var</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">:</span>
			<span class="n">tab</span><span class="o">.</span><span class="n">hasData</span><span class="o">.</span><span class="n">trace_vdelete</span><span class="p">(</span><span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">chk</span><span class="o">.</span><span class="n">traceID</span><span class="p">)</span></div>


<div class="viewcode-block" id="FittingOptionsFrame"><a class="viewcode-back" href="../../index.html#paramagpy.gui.FittingOptionsFrame">[docs]</a><span class="k">class</span> <span class="nc">FittingOptionsFrame</span><span class="p">(</span><span class="n">tk</span><span class="o">.</span><span class="n">LabelFrame</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Fitting options and logical combinations</span>
<span class="sd">	Affects starting tensor values</span>
<span class="sd">	&quot;&quot;&quot;</span>
	<span class="n">varNames</span> <span class="o">=</span> <span class="p">{</span>
	<span class="s1">&#39;svd&#39;</span><span class="p">:</span><span class="s1">&#39;SVD Gridsearch&#39;</span><span class="p">,</span>
	<span class="s1">&#39;nlr&#39;</span><span class="p">:</span><span class="s1">&#39;NLR Gradient Descent&#39;</span><span class="p">,</span>
	<span class="s1">&#39;ref&#39;</span><span class="p">:</span><span class="s1">&#39;Fit Offset&#39;</span><span class="p">,</span>
	<span class="s1">&#39;pos&#39;</span><span class="p">:</span><span class="s1">&#39;Fit Position&#39;</span><span class="p">,</span>
	<span class="s1">&#39;rad&#39;</span><span class="p">:</span><span class="s1">&#39;SVD Radius/</span><span class="se">\u00c5</span><span class="s1">&#39;</span><span class="p">,</span>
	<span class="s1">&#39;den&#39;</span><span class="p">:</span><span class="s1">&#39;SVD Grid Spacing/</span><span class="se">\u00c5</span><span class="s1">&#39;</span><span class="p">,</span>
	<span class="s1">&#39;mod&#39;</span><span class="p">:</span><span class="s1">&#39;Fit Separate Models&#39;</span><span class="p">,</span>
	<span class="s1">&#39;racs&#39;</span><span class="p">:</span><span class="s1">&#39;Use RACS&#39;</span><span class="p">,</span>
	<span class="s1">&#39;rads&#39;</span><span class="p">:</span><span class="s1">&#39;Use RADS&#39;</span><span class="p">,</span>
	<span class="s1">&#39;taur&#39;</span><span class="p">:</span><span class="s1">&#39;Fit </span><span class="se">\u03c4</span><span class="s1">r&#39;</span><span class="p">,</span>
	<span class="s1">&#39;taue&#39;</span><span class="p">:</span><span class="s1">&#39;Fit T1e&#39;</span><span class="p">,</span>
	<span class="s1">&#39;dsa&#39;</span><span class="p">:</span><span class="s1">&#39;Use DSA&#39;</span><span class="p">,</span>
	<span class="s1">&#39;sbm&#39;</span><span class="p">:</span><span class="s1">&#39;Use SBM&#39;</span><span class="p">,</span>
	<span class="s1">&#39;csa&#39;</span><span class="p">:</span><span class="s1">&#39;Use CSA&#39;</span><span class="p">,</span>
	<span class="s1">&#39;dchi&#39;</span><span class="p">:</span><span class="s1">&#39;Fit </span><span class="se">\u0394\u03c7</span><span class="s1"> tensor&#39;</span><span class="p">,</span>
	<span class="s1">&#39;iso&#39;</span><span class="p">:</span><span class="s1">&#39;Fit </span><span class="se">\u03c7</span><span class="s1">iso&#39;</span><span class="p">,</span>
	<span class="p">}</span>

	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">):</span>
		<span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Fitting Options&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span> <span class="c1"># MethodsTab</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">dtype</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">dtype</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">fields</span> <span class="o">=</span> <span class="p">{}</span>

		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="o">==</span><span class="s1">&#39;PCS&#39;</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">set_checkbox</span><span class="p">(</span><span class="s1">&#39;ref&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">set_checkbox</span><span class="p">(</span><span class="s1">&#39;pos&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">set_checkbox</span><span class="p">(</span><span class="s1">&#39;mod&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
			<span class="n">ttk</span><span class="o">.</span><span class="n">Separator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">orient</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span>
				<span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">rowspan</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;ns&#39;</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">set_checkbox</span><span class="p">(</span><span class="s1">&#39;svd&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">set_field</span><span class="p">(</span><span class="s1">&#39;rad&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">set_field</span><span class="p">(</span><span class="s1">&#39;den&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
			<span class="n">ttk</span><span class="o">.</span><span class="n">Separator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">orient</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span>
				<span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">rowspan</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;ns&#39;</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">set_checkbox</span><span class="p">(</span><span class="s1">&#39;nlr&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">set_checkbox</span><span class="p">(</span><span class="s1">&#39;racs&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">set_checkbox</span><span class="p">(</span><span class="s1">&#39;rads&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

		<span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="o">==</span><span class="s1">&#39;RDC&#39;</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">set_checkbox</span><span class="p">(</span><span class="s1">&#39;mod&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

		<span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="o">==</span><span class="s1">&#39;PRE&#39;</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">set_checkbox</span><span class="p">(</span><span class="s1">&#39;iso&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">set_checkbox</span><span class="p">(</span><span class="s1">&#39;pos&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">set_checkbox</span><span class="p">(</span><span class="s1">&#39;mod&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

			<span class="bp">self</span><span class="o">.</span><span class="n">set_checkbox</span><span class="p">(</span><span class="s1">&#39;dchi&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">set_checkbox</span><span class="p">(</span><span class="s1">&#39;taur&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">set_checkbox</span><span class="p">(</span><span class="s1">&#39;taue&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

			<span class="bp">self</span><span class="o">.</span><span class="n">set_checkbox</span><span class="p">(</span><span class="s1">&#39;dsa&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">set_checkbox</span><span class="p">(</span><span class="s1">&#39;sbm&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">set_checkbox</span><span class="p">(</span><span class="s1">&#39;csa&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>


	<span class="nd">@property</span>
	<span class="k">def</span> <span class="nf">frm_pdb</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">frm_coords</span><span class="o">.</span><span class="n">frm_pdb</span>

	<span class="nd">@property</span>
	<span class="k">def</span> <span class="nf">tensorStart</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">ntb_data</span><span class="o">.</span><span class="n">current_tab</span><span class="o">.</span><span class="n">tensorStart</span>

	<span class="k">def</span> <span class="nf">set_checkbox</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">variableName</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">colspan</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
		<span class="n">var</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">IntVar</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="n">state</span><span class="p">)</span>
		<span class="n">chk</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Checkbutton</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">varNames</span><span class="p">[</span><span class="n">variableName</span><span class="p">],</span> 
			<span class="n">variable</span><span class="o">=</span><span class="n">var</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">)</span>
		<span class="n">Tooltip</span><span class="p">(</span><span class="n">chk</span><span class="p">,</span> <span class="n">tt</span><span class="p">[</span><span class="n">variableName</span><span class="p">])</span>
		<span class="n">chk</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">row</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="n">col</span><span class="p">,</span> <span class="n">columnspan</span><span class="o">=</span><span class="n">colspan</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;W&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="n">variableName</span><span class="p">]</span> <span class="o">=</span> <span class="n">var</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">variableName</span><span class="p">]</span> <span class="o">=</span> <span class="n">chk</span>
		<span class="k">return</span> <span class="n">chk</span>

	<span class="k">def</span> <span class="nf">set_field</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">variableName</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">colspan</span><span class="p">,</span> <span class="n">default</span><span class="p">):</span>
		<span class="n">field</span> <span class="o">=</span> <span class="n">NumericEntry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">default</span><span class="p">,</span> <span class="n">onlyPositive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
		<span class="n">label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">varNames</span><span class="p">[</span><span class="n">variableName</span><span class="p">])</span>
		<span class="n">Tooltip</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">tt</span><span class="p">[</span><span class="n">variableName</span><span class="p">])</span>
		<span class="n">Tooltip</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">tt</span><span class="p">[</span><span class="n">variableName</span><span class="p">])</span>
		<span class="n">field</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">label</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">variableName</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="n">variableName</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">floatVar</span>
		<span class="n">label</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">row</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="n">col</span><span class="p">,</span><span class="n">columnspan</span><span class="o">=</span><span class="n">colspan</span><span class="p">,</span><span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;W&#39;</span><span class="p">)</span>
		<span class="n">field</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">row</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="n">col</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">columnspan</span><span class="o">=</span><span class="n">colspan</span><span class="p">)</span>

<div class="viewcode-block" id="FittingOptionsFrame.update"><a class="viewcode-back" href="../../index.html#paramagpy.gui.FittingOptionsFrame.update">[docs]</a>	<span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">strength</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="o">==</span><span class="s1">&#39;PCS&#39;</span><span class="p">:</span>
			<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;svd&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="s1">&#39;rad&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">disable</span><span class="p">()</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="s1">&#39;den&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">disable</span><span class="p">()</span>
			<span class="k">elif</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;pos&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="s1">&#39;rad&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">floatVar</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="s1">&#39;rad&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="s1">&#39;rad&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">disable</span><span class="p">()</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="s1">&#39;den&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">disable</span><span class="p">()</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="s1">&#39;rad&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">enable</span><span class="p">()</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="s1">&#39;den&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">enable</span><span class="p">()</span>


		<span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span></div>

	<span class="k">def</span> <span class="nf">single_calc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataTab</span><span class="p">):</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="o">==</span><span class="s1">&#39;PCS&#39;</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">fit_pcs</span><span class="p">([</span><span class="n">dataTab</span><span class="p">])</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="o">==</span><span class="s1">&#39;RDC&#39;</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">fit_rdc</span><span class="p">(</span><span class="n">dataTab</span><span class="p">)</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="o">==</span><span class="s1">&#39;PRE&#39;</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">fit_pre</span><span class="p">([</span><span class="n">dataTab</span><span class="p">])</span>

	<span class="k">def</span> <span class="nf">multiple_calc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataTabs</span><span class="p">):</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="o">==</span><span class="s1">&#39;PCS&#39;</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">fit_pcs</span><span class="p">(</span><span class="n">dataTabs</span><span class="p">)</span>

	<span class="k">def</span> <span class="nf">get_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataTabs</span><span class="p">,</span> <span class="n">seperateModels</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
		<span class="k">if</span> <span class="n">seperateModels</span><span class="p">:</span>
			<span class="n">models</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">frm_pdb</span><span class="o">.</span><span class="n">models</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">models</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span>
		<span class="n">modeldata</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;PCS&#39;</span><span class="p">,</span><span class="s1">&#39;PRE&#39;</span><span class="p">]:</span>
			<span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">models</span><span class="p">:</span>
				<span class="n">fitdata</span> <span class="o">=</span> <span class="p">[</span><span class="n">tab</span><span class="o">.</span><span class="n">get_fit_data</span><span class="p">(</span><span class="n">model</span><span class="p">)</span> <span class="k">for</span> <span class="n">tab</span> <span class="ow">in</span> <span class="n">dataTabs</span><span class="p">]</span>
				<span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">d</span><span class="p">[[</span><span class="s1">&#39;atm&#39;</span><span class="p">,</span><span class="s1">&#39;exp&#39;</span><span class="p">,</span><span class="s1">&#39;err&#39;</span><span class="p">]]</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">fitdata</span><span class="p">]</span>
				<span class="n">tmp</span> <span class="o">=</span> <span class="n">model</span><span class="p">,</span> <span class="n">data</span>
				<span class="n">modeldata</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>
			<span class="k">return</span> <span class="n">modeldata</span>
		<span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="o">==</span><span class="s1">&#39;RDC&#39;</span><span class="p">:</span>
			<span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">models</span><span class="p">:</span>
				<span class="n">fitdata</span> <span class="o">=</span> <span class="n">dataTab</span><span class="o">.</span><span class="n">get_fit_data</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
				<span class="n">data</span> <span class="o">=</span> <span class="n">fitdata</span><span class="p">[[</span><span class="s1">&#39;atm&#39;</span><span class="p">,</span><span class="s1">&#39;atx&#39;</span><span class="p">,</span><span class="s1">&#39;exp&#39;</span><span class="p">,</span><span class="s1">&#39;err&#39;</span><span class="p">]]</span>
				<span class="n">summ</span> <span class="o">=</span> <span class="n">fitdata</span><span class="p">[</span><span class="s1">&#39;idx&#39;</span><span class="p">]</span>
				<span class="n">tmp</span> <span class="o">=</span> <span class="n">model</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">summ</span>
				<span class="n">modeldata</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>
			<span class="k">return</span> <span class="n">modeldata</span>

	<span class="k">def</span> <span class="nf">get_params</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="o">==</span><span class="s1">&#39;PCS&#39;</span><span class="p">:</span>
			<span class="n">pars</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ax&#39;</span><span class="p">,</span><span class="s1">&#39;rh&#39;</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;g&#39;</span><span class="p">]</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;pos&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
				<span class="n">pars</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="p">]</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;ref&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
				<span class="n">pars</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;shift&#39;</span><span class="p">]</span>
			<span class="k">return</span> <span class="n">pars</span>
		<span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="o">==</span><span class="s1">&#39;PRE&#39;</span><span class="p">:</span>
			<span class="n">pars</span> <span class="o">=</span> <span class="p">[]</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;pos&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
				<span class="n">pars</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="p">]</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;iso&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
				<span class="n">pars</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;iso&#39;</span><span class="p">]</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;dchi&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
				<span class="n">pars</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;ax&#39;</span><span class="p">,</span><span class="s1">&#39;rh&#39;</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;g&#39;</span><span class="p">]</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;taur&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
				<span class="n">pars</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;taur&#39;</span><span class="p">]</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;taue&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
				<span class="n">pars</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;t1e&#39;</span><span class="p">]</span>
			<span class="k">return</span> <span class="n">pars</span>



	<span class="k">def</span> <span class="nf">fit_pcs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataTabs</span><span class="p">):</span>
		<span class="n">metals</span> <span class="o">=</span> <span class="p">[</span><span class="n">tab</span><span class="o">.</span><span class="n">tensorStart</span><span class="o">.</span><span class="n">tensor</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">for</span> <span class="n">tab</span> <span class="ow">in</span> <span class="n">dataTabs</span><span class="p">]</span>
		<span class="n">modeldata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">dataTabs</span><span class="p">,</span> 
			<span class="n">seperateModels</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;mod&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>

		<span class="c1"># datacheck = all([all([bool(j) for j in d]) for m, d, s in modeldata])</span>
		<span class="c1"># if not datacheck:</span>
		<span class="c1"># 	messagebox.showerror(&quot;Error&quot;, &quot;Experimental data missing&quot;)</span>
		<span class="c1"># 	return</span>

		<span class="n">qfac</span> <span class="o">=</span> <span class="mf">1E50</span>
		<span class="n">minmod</span> <span class="o">=</span> <span class="kc">None</span>
		<span class="n">minmetal</span> <span class="o">=</span> <span class="kc">None</span>
		<span class="n">progVar</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">DoubleVar</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
		<span class="n">progbar</span> <span class="o">=</span> <span class="n">ProgressPopup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">progVar</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">auto_close</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
		<span class="k">for</span> <span class="n">model</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">modeldata</span><span class="p">:</span>
			<span class="k">if</span> <span class="n">model</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
				<span class="n">svdline</span> <span class="o">=</span> <span class="s2">&quot;Model: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">SVD Gridsearch . . .&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
				<span class="n">nlrline</span> <span class="o">=</span> <span class="s2">&quot;Model: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">NLR Fitting . . .&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">svdline</span> <span class="o">=</span> <span class="s2">&quot;SVD Gridsearch . . .&quot;</span>
				<span class="n">nlrline</span> <span class="o">=</span> <span class="s2">&quot;NLR Fitting . . .&quot;</span>

			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;svd&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
				<span class="n">progbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">svdline</span><span class="p">)</span>
				<span class="n">progVar</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
				<span class="n">radius</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="s1">&#39;rad&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
				<span class="n">points</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">radius</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="s1">&#39;den&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">()))</span>
				<span class="k">if</span> <span class="n">points</span><span class="o">&lt;</span><span class="mi">1</span><span class="p">:</span>
					<span class="n">points</span> <span class="o">=</span> <span class="mi">1</span>
				<span class="n">ref</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;ref&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
				<span class="n">metals</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">svd_gridsearch_fit_metal_from_pcs</span><span class="p">(</span><span class="n">metals</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span>
					<span class="n">origin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="n">radius</span><span class="p">,</span> <span class="n">points</span><span class="o">=</span><span class="n">points</span><span class="p">,</span> 
					<span class="n">offsetShift</span><span class="o">=</span><span class="n">ref</span><span class="p">,</span> <span class="n">progress</span><span class="o">=</span><span class="n">progVar</span><span class="p">)</span>

			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;nlr&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
				<span class="n">progbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">nlrline</span><span class="p">)</span>
				<span class="n">progVar</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
				<span class="n">pars</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span>
				<span class="n">metals</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">nlr_fit_metal_from_pcs</span><span class="p">(</span><span class="n">metals</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">pars</span><span class="p">,</span>
					<span class="n">userads</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;rads&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span> 
					<span class="n">useracs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;racs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>

			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;mod&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
				<span class="n">q</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">fit</span><span class="o">.</span><span class="n">qfactor</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="k">for</span> <span class="n">m</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">metals</span><span class="p">,</span> <span class="n">data</span><span class="p">)])</span>
				<span class="k">if</span> <span class="n">q</span><span class="o">&lt;</span><span class="n">qfac</span><span class="p">:</span>
					<span class="n">minmod</span> <span class="o">=</span> <span class="n">model</span>
					<span class="n">minmetals</span> <span class="o">=</span> <span class="p">[</span><span class="n">m</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">metals</span><span class="p">]</span>
					<span class="n">qfac</span> <span class="o">=</span> <span class="n">q</span>

		<span class="n">progbar</span><span class="o">.</span><span class="n">death</span><span class="p">()</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;mod&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
			<span class="n">line</span> <span class="o">=</span> <span class="s2">&quot;Model </span><span class="si">{0:}</span><span class="s2"> found with minimum Q-factor of </span><span class="si">{1:5.3f}</span><span class="s2">&quot;</span>
			<span class="n">messagebox</span><span class="o">.</span><span class="n">showinfo</span><span class="p">(</span><span class="s2">&quot;Model with best fit found&quot;</span><span class="p">,</span> 
				<span class="n">line</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">minmod</span><span class="p">,</span> <span class="n">qfac</span><span class="p">))</span>
			<span class="n">metals</span> <span class="o">=</span> <span class="n">minmetals</span>

		<span class="k">for</span> <span class="n">tab</span><span class="p">,</span> <span class="n">metal</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">dataTabs</span><span class="p">,</span> <span class="n">metals</span><span class="p">):</span>
			<span class="n">metal</span><span class="o">.</span><span class="n">set_utr</span><span class="p">()</span>
			<span class="n">tab</span><span class="o">.</span><span class="n">tensorFit</span><span class="o">.</span><span class="n">tensor</span> <span class="o">=</span> <span class="n">metal</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
			<span class="k">if</span> <span class="n">minmod</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
				<span class="n">tab</span><span class="o">.</span><span class="n">viewData</span><span class="o">.</span><span class="n">set_current_model</span><span class="p">(</span><span class="n">minmod</span><span class="p">)</span>
			<span class="n">tab</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
			<span class="n">tab</span><span class="o">.</span><span class="n">back_calc</span><span class="p">()</span>

	<span class="k">def</span> <span class="nf">error_pcs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataTabs</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">iters</span><span class="p">,</span> <span class="n">bsfrac</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">singleModel</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
		<span class="n">metals</span> <span class="o">=</span> <span class="p">[</span><span class="n">tab</span><span class="o">.</span><span class="n">tensorFit</span><span class="o">.</span><span class="n">tensor</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">for</span> <span class="n">tab</span> <span class="ow">in</span> <span class="n">dataTabs</span><span class="p">]</span>
		<span class="k">if</span> <span class="n">singleModel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
			<span class="n">modeldata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">dataTabs</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">modeldata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">dataTabs</span><span class="p">,</span> <span class="n">seperateModels</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
			<span class="n">tmp</span> <span class="o">=</span> <span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="n">singleModel</span><span class="p">,</span> <span class="n">modeldata</span><span class="p">)</span>
			<span class="n">modeldata</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">tmp</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

		<span class="k">if</span> <span class="n">method</span><span class="o">==</span><span class="s1">&#39;mc&#39;</span><span class="p">:</span>
			<span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Monte Calro Simulation&quot;</span>
		<span class="k">elif</span> <span class="n">method</span><span class="o">==</span><span class="s1">&#39;bs&#39;</span><span class="p">:</span>
			<span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Bootstrapping Simulation&quot;</span>

		<span class="n">progVar</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">DoubleVar</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
		<span class="n">progbar</span> <span class="o">=</span> <span class="n">ProgressPopup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">progVar</span><span class="p">,</span> 
			<span class="s2">&quot;Repeating NLR with noise . . .&quot;</span><span class="p">,</span>
			<span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">auto_close</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
		<span class="n">pars</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span>
		<span class="n">model</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">modeldata</span>

		<span class="k">if</span> <span class="n">method</span><span class="o">==</span><span class="s1">&#39;mc&#39;</span><span class="p">:</span>
			<span class="n">stds</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">pcs_fit_error_monte_carlo</span><span class="p">(</span><span class="n">metals</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">pars</span><span class="p">,</span> <span class="n">iters</span><span class="p">,</span> 
				<span class="n">userads</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;rads&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span> 
				<span class="n">useracs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;racs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span> 
				<span class="n">progress</span><span class="o">=</span><span class="n">progVar</span><span class="p">)</span>
		<span class="k">elif</span> <span class="n">method</span><span class="o">==</span><span class="s1">&#39;bs&#39;</span><span class="p">:</span>
			<span class="n">stds</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">pcs_fit_error_bootstrap</span><span class="p">(</span><span class="n">metals</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">pars</span><span class="p">,</span> <span class="n">iters</span><span class="p">,</span> 
				<span class="n">bsfrac</span><span class="p">,</span> 
				<span class="n">userads</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;rads&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span> 
				<span class="n">useracs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;racs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span> 
				<span class="n">progress</span><span class="o">=</span><span class="n">progVar</span><span class="p">)</span>

		<span class="n">deviations</span> <span class="o">=</span> <span class="p">{}</span>
		<span class="k">for</span> <span class="n">tab</span><span class="p">,</span> <span class="n">std</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">dataTabs</span><span class="p">,</span> <span class="n">stds</span><span class="p">):</span>
			<span class="k">if</span> <span class="n">tab</span><span class="o">.</span><span class="n">is_current</span><span class="p">():</span>
				<span class="n">scatter</span> <span class="o">=</span> <span class="n">std</span>
				<span class="k">for</span> <span class="n">param</span><span class="p">,</span> <span class="n">values</span> <span class="ow">in</span> <span class="n">std</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
					<span class="n">value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
					<span class="n">deviations</span><span class="p">[</span><span class="n">param</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

		<span class="n">progbar</span><span class="o">.</span><span class="n">death</span><span class="p">()</span>
		<span class="k">return</span> <span class="n">scatter</span><span class="p">,</span> <span class="n">deviations</span>

	<span class="k">def</span> <span class="nf">fit_pre</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataTabs</span><span class="p">):</span>
		<span class="n">metals</span> <span class="o">=</span> <span class="p">[</span><span class="n">tab</span><span class="o">.</span><span class="n">tensorStart</span><span class="o">.</span><span class="n">tensor</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">for</span> <span class="n">tab</span> <span class="ow">in</span> <span class="n">dataTabs</span><span class="p">]</span>
		<span class="n">rtypes</span> <span class="o">=</span> <span class="p">[</span><span class="n">tab</span><span class="o">.</span><span class="n">rtype</span><span class="p">()</span> <span class="k">for</span> <span class="n">tab</span> <span class="ow">in</span> <span class="n">dataTabs</span><span class="p">]</span>
		<span class="n">modeldata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">dataTabs</span><span class="p">,</span> 
			<span class="n">seperateModels</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;mod&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>

		<span class="c1"># datacheck = all([all([bool(j) for j in d]) for m, d, s in modeldata])</span>
		<span class="c1"># if not datacheck:</span>
		<span class="c1"># 	messagebox.showerror(&quot;Error&quot;, &quot;Experimental data missing&quot;)</span>
		<span class="c1"># 	return</span>

		<span class="n">qfac</span> <span class="o">=</span> <span class="mf">1E50</span>
		<span class="n">minmod</span> <span class="o">=</span> <span class="kc">None</span>
		<span class="n">minmetal</span> <span class="o">=</span> <span class="kc">None</span>
		<span class="n">progVar</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">DoubleVar</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
		<span class="n">progbar</span> <span class="o">=</span> <span class="n">ProgressPopup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">progVar</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">auto_close</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
		<span class="k">for</span> <span class="n">model</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">modeldata</span><span class="p">:</span>
			<span class="k">if</span> <span class="n">model</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
				<span class="n">nlrline</span> <span class="o">=</span> <span class="s2">&quot;Model: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">NLR Fitting . . .&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">nlrline</span> <span class="o">=</span> <span class="s2">&quot;NLR Fitting . . .&quot;</span>

			<span class="n">progbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">nlrline</span><span class="p">)</span>
			<span class="n">progVar</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
			<span class="n">pars</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span>
			<span class="n">metals</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">nlr_fit_metal_from_pre</span><span class="p">(</span><span class="n">metals</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">pars</span><span class="p">,</span>
				<span class="n">rtypes</span><span class="o">=</span><span class="n">rtypes</span><span class="p">,</span>
				<span class="n">usesbm</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;sbm&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span> 
				<span class="n">usedsa</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;dsa&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span>
				<span class="n">usecsa</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;csa&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>

			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;mod&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
				<span class="n">q</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">fit</span><span class="o">.</span><span class="n">qfactor</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="k">for</span> <span class="n">m</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">metals</span><span class="p">,</span> <span class="n">data</span><span class="p">)])</span>
				<span class="k">if</span> <span class="n">q</span><span class="o">&lt;</span><span class="n">qfac</span><span class="p">:</span>
					<span class="n">minmod</span> <span class="o">=</span> <span class="n">model</span>
					<span class="n">minmetals</span> <span class="o">=</span> <span class="p">[</span><span class="n">m</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">metals</span><span class="p">]</span>
					<span class="n">qfac</span> <span class="o">=</span> <span class="n">q</span>

		<span class="n">progbar</span><span class="o">.</span><span class="n">death</span><span class="p">()</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;mod&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
			<span class="n">line</span> <span class="o">=</span> <span class="s2">&quot;Model </span><span class="si">{0:}</span><span class="s2"> found with minimum Q-factor of </span><span class="si">{1:5.3f}</span><span class="s2">&quot;</span>
			<span class="n">messagebox</span><span class="o">.</span><span class="n">showinfo</span><span class="p">(</span><span class="s2">&quot;Model with best fit found&quot;</span><span class="p">,</span> 
				<span class="n">line</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">minmod</span><span class="p">,</span> <span class="n">qfac</span><span class="p">))</span>
			<span class="n">metals</span> <span class="o">=</span> <span class="n">minmetals</span>

		<span class="k">for</span> <span class="n">tab</span><span class="p">,</span> <span class="n">metal</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">dataTabs</span><span class="p">,</span> <span class="n">metals</span><span class="p">):</span>
			<span class="n">metal</span><span class="o">.</span><span class="n">set_utr</span><span class="p">()</span>
			<span class="n">tab</span><span class="o">.</span><span class="n">tensorFit</span><span class="o">.</span><span class="n">tensor</span> <span class="o">=</span> <span class="n">metal</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
			<span class="k">if</span> <span class="n">minmod</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
				<span class="n">tab</span><span class="o">.</span><span class="n">viewData</span><span class="o">.</span><span class="n">set_current_model</span><span class="p">(</span><span class="n">minmod</span><span class="p">)</span>
			<span class="n">tab</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
			<span class="n">tab</span><span class="o">.</span><span class="n">back_calc</span><span class="p">()</span>


	<span class="k">def</span> <span class="nf">fit_rdc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataTab</span><span class="p">):</span>
		<span class="n">metal</span> <span class="o">=</span> <span class="n">dataTab</span><span class="o">.</span><span class="n">tensorStart</span><span class="o">.</span><span class="n">tensor</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
		<span class="n">modeldata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">dataTab</span><span class="p">,</span> 
			<span class="n">seperateModels</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;mod&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>

		<span class="c1"># datacheck = all([all([bool(j) for j in d]) for m, d, s in modeldata])</span>
		<span class="c1"># if not datacheck:</span>
		<span class="c1"># 	messagebox.showerror(&quot;Error&quot;, &quot;Experimental data missing&quot;)</span>
		<span class="c1"># 	return</span>

		<span class="n">qfac</span> <span class="o">=</span> <span class="mf">1E50</span>
		<span class="n">minmod</span> <span class="o">=</span> <span class="kc">None</span>
		<span class="n">minmetal</span> <span class="o">=</span> <span class="kc">None</span>
		<span class="n">progVar</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">DoubleVar</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
		<span class="k">for</span> <span class="n">model</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">summ</span> <span class="ow">in</span> <span class="n">modeldata</span><span class="p">:</span>
			<span class="n">metal</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">svd_fit_metal_from_rdc</span><span class="p">(</span><span class="n">metal</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>


			<span class="c1"># if self.params[&#39;mod&#39;].get():</span>
			<span class="c1"># 	q = sum([fit.qfactor(m, d) for m, d in zip(metals, data)])</span>
			<span class="c1"># 	if q&lt;qfac:</span>
			<span class="c1"># 		minmod = model</span>
			<span class="c1"># 		minmetals = [m.copy() for m in metals]</span>
			<span class="c1"># 		qfac = q</span>

		<span class="c1"># if self.params[&#39;mod&#39;].get():</span>
		<span class="c1"># 	line = &quot;Model {0:} found with minimum Q-factor of {1:5.3f}&quot;</span>
		<span class="c1"># 	messagebox.showinfo(&quot;Model with best fit found&quot;, </span>
		<span class="c1"># 		line.format(minmod, qfac))</span>
		<span class="c1"># 	metals = minmetals</span>

		<span class="n">metal</span><span class="o">.</span><span class="n">set_utr</span><span class="p">()</span>
		<span class="nb">print</span><span class="p">(</span><span class="n">metal</span><span class="o">.</span><span class="n">info</span><span class="p">())</span>
		<span class="n">dataTab</span><span class="o">.</span><span class="n">tensorFit</span><span class="o">.</span><span class="n">tensor</span> <span class="o">=</span> <span class="n">metal</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
		<span class="c1"># if minmod is not None:</span>
			<span class="c1"># dataTab.viewData.set_current_model(minmod)</span>
		<span class="n">dataTab</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
		<span class="n">dataTab</span><span class="o">.</span><span class="n">back_calc</span><span class="p">()</span></div>


<div class="viewcode-block" id="DataNotebook"><a class="viewcode-back" href="../../index.html#paramagpy.gui.DataNotebook">[docs]</a><span class="k">class</span> <span class="nc">DataNotebook</span><span class="p">(</span><span class="n">ttk</span><span class="o">.</span><span class="n">Notebook</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Notebook for datasets</span>
<span class="sd">	&quot;&quot;&quot;</span>
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">num_tabs</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
		<span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span> <span class="c1"># MethodsTab</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">dtype</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">dtype</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">tabs</span> <span class="o">=</span> <span class="p">[]</span>

		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">num_tabs</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
			<span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Data </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
			<span class="n">tab</span> <span class="o">=</span> <span class="n">DataTab</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tab</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">tabs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tab</span><span class="p">)</span>

		<span class="bp">self</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;&lt;NotebookTabChanged&gt;&gt;&quot;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>

<div class="viewcode-block" id="DataNotebook.update"><a class="viewcode-back" href="../../index.html#paramagpy.gui.DataNotebook.update">[docs]</a>	<span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">strength</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
		<span class="k">for</span> <span class="n">tab</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tabs</span><span class="p">:</span>
			<span class="n">tab</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">strength</span><span class="p">)</span></div>

	<span class="nd">@property</span>
	<span class="k">def</span> <span class="nf">current_tab</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tabs</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;current&#39;</span><span class="p">)]</span></div>


<div class="viewcode-block" id="MethodsTab"><a class="viewcode-back" href="../../index.html#paramagpy.gui.MethodsTab">[docs]</a><span class="k">class</span> <span class="nc">MethodsTab</span><span class="p">(</span><span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	A single tab for PCS, RDC or PRE</span>
<span class="sd">	frm_fitopts : fitting options frame</span>
<span class="sd">	frm_data : data notebook containing data display and tensors</span>
<span class="sd">	&quot;&quot;&quot;</span>
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">dtype</span><span class="p">):</span>
		<span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span> <span class="c1"># MethodsNotebook</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">dtype</span> <span class="o">=</span> <span class="n">dtype</span>

		<span class="bp">self</span><span class="o">.</span><span class="n">frm_fopts</span> <span class="o">=</span> <span class="n">FittingOptionsFrame</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">ntb_data</span> <span class="o">=</span> <span class="n">DataNotebook</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

		<span class="bp">self</span><span class="o">.</span><span class="n">frm_fopts</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">ntb_data</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">columnspan</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;PCS&#39;</span><span class="p">,</span><span class="s1">&#39;PRE&#39;</span><span class="p">]:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">frm_fmul</span> <span class="o">=</span> <span class="n">MultipleFitFrame</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">frm_fmul</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;NS&#39;</span><span class="p">)</span>

<div class="viewcode-block" id="MethodsTab.update"><a class="viewcode-back" href="../../index.html#paramagpy.gui.MethodsTab.update">[docs]</a>	<span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">strength</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_current</span><span class="p">():</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">ntb_data</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">strength</span><span class="p">)</span></div>

	<span class="k">def</span> <span class="nf">is_current</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">==</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">current_tab</span><span class="p">:</span>
			<span class="k">return</span> <span class="kc">True</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="k">return</span> <span class="kc">False</span></div>


<div class="viewcode-block" id="MethodsNotebook"><a class="viewcode-back" href="../../index.html#paramagpy.gui.MethodsNotebook">[docs]</a><span class="k">class</span> <span class="nc">MethodsNotebook</span><span class="p">(</span><span class="n">ttk</span><span class="o">.</span><span class="n">Notebook</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Contains tabs of PCS, RDC and CSA</span>
<span class="sd">	Generates numpy structured array templates for data storage and</span>
<span class="sd">	are stored in dictionary &lt;templates&gt;</span>
<span class="sd">	&quot;&quot;&quot;</span>
	<span class="n">structdtype</span> <span class="o">=</span> <span class="p">{</span>
		<span class="s1">&#39;PCS&#39;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="p">([</span>
					<span class="p">(</span><span class="s1">&#39;mdl&#39;</span><span class="p">,</span> <span class="nb">int</span>   <span class="p">),</span>
					<span class="p">(</span><span class="s1">&#39;use&#39;</span><span class="p">,</span> <span class="nb">bool</span>  <span class="p">),</span>
					<span class="p">(</span><span class="s1">&#39;atm&#39;</span><span class="p">,</span> <span class="nb">object</span><span class="p">),</span>
					<span class="p">(</span><span class="s1">&#39;cal&#39;</span><span class="p">,</span> <span class="nb">float</span> <span class="p">),</span>
					<span class="p">(</span><span class="s1">&#39;exp&#39;</span><span class="p">,</span> <span class="nb">float</span> <span class="p">),</span>
					<span class="p">(</span><span class="s1">&#39;err&#39;</span><span class="p">,</span> <span class="nb">float</span> <span class="p">),</span>
					<span class="p">(</span><span class="s1">&#39;idx&#39;</span><span class="p">,</span> <span class="nb">int</span>   <span class="p">)]),</span>
		<span class="s1">&#39;RDC&#39;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="p">([</span>
					<span class="p">(</span><span class="s1">&#39;mdl&#39;</span><span class="p">,</span>  <span class="nb">int</span>   <span class="p">),</span>
					<span class="p">(</span><span class="s1">&#39;use&#39;</span><span class="p">,</span>  <span class="nb">bool</span>  <span class="p">),</span>
					<span class="p">(</span><span class="s1">&#39;atm&#39;</span><span class="p">,</span>  <span class="nb">object</span><span class="p">),</span>
					<span class="p">(</span><span class="s1">&#39;atx&#39;</span><span class="p">,</span>  <span class="nb">object</span><span class="p">),</span>
					<span class="p">(</span><span class="s1">&#39;cal&#39;</span><span class="p">,</span>  <span class="nb">float</span> <span class="p">),</span>
					<span class="p">(</span><span class="s1">&#39;exp&#39;</span><span class="p">,</span>  <span class="nb">float</span> <span class="p">),</span>
					<span class="p">(</span><span class="s1">&#39;err&#39;</span><span class="p">,</span>  <span class="nb">float</span> <span class="p">),</span>
					<span class="p">(</span><span class="s1">&#39;idx&#39;</span><span class="p">,</span>  <span class="nb">int</span>   <span class="p">)]),</span>
		<span class="s1">&#39;PRE&#39;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="p">([</span>
					<span class="p">(</span><span class="s1">&#39;mdl&#39;</span><span class="p">,</span> <span class="nb">int</span>   <span class="p">),</span>
					<span class="p">(</span><span class="s1">&#39;use&#39;</span><span class="p">,</span> <span class="nb">bool</span>  <span class="p">),</span>
					<span class="p">(</span><span class="s1">&#39;atm&#39;</span><span class="p">,</span> <span class="nb">object</span><span class="p">),</span>
					<span class="p">(</span><span class="s1">&#39;cal&#39;</span><span class="p">,</span> <span class="nb">float</span> <span class="p">),</span>
					<span class="p">(</span><span class="s1">&#39;exp&#39;</span><span class="p">,</span> <span class="nb">float</span> <span class="p">),</span>
					<span class="p">(</span><span class="s1">&#39;err&#39;</span><span class="p">,</span> <span class="nb">float</span> <span class="p">),</span>
					<span class="p">(</span><span class="s1">&#39;idx&#39;</span><span class="p">,</span> <span class="nb">int</span>   <span class="p">)])}</span>

	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">):</span>
		<span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span> <span class="c1"># MainGui</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">dtypes</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;PCS&#39;</span><span class="p">,</span><span class="s1">&#39;RDC&#39;</span><span class="p">,</span><span class="s1">&#39;PRE&#39;</span><span class="p">]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">tabs</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">templates</span> <span class="o">=</span> <span class="p">{</span><span class="n">i</span><span class="p">:</span><span class="kc">None</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtypes</span><span class="p">}</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">copied_tensor</span> <span class="o">=</span> <span class="kc">None</span>
		<span class="k">for</span> <span class="n">dtype</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtypes</span><span class="p">:</span>
			<span class="n">tab</span> <span class="o">=</span> <span class="n">MethodsTab</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dtype</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tab</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">tabs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tab</span><span class="p">)</span>

		<span class="bp">self</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;&lt;NotebookTabChanged&gt;&gt;&quot;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>

<div class="viewcode-block" id="MethodsNotebook.update"><a class="viewcode-back" href="../../index.html#paramagpy.gui.MethodsNotebook.update">[docs]</a>	<span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">strength</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Templates are only updated if a change </span>
<span class="sd">		is made to the PDB file or selection</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="k">if</span> <span class="n">strength</span><span class="o">&gt;=</span><span class="mi">2</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">make_templates</span><span class="p">()</span>
		<span class="k">for</span> <span class="n">tab</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tabs</span><span class="p">:</span>
			<span class="n">tab</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">strength</span><span class="p">)</span></div>

	<span class="nd">@property</span>
	<span class="k">def</span> <span class="nf">current_tab</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tabs</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;current&#39;</span><span class="p">)]</span>

	<span class="nd">@property</span>
	<span class="k">def</span> <span class="nf">frm_pdb</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">frm_coords</span><span class="o">.</span><span class="n">frm_pdb</span>

	<span class="k">def</span> <span class="nf">make_templates</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="n">templates</span> <span class="o">=</span> <span class="p">{</span><span class="n">i</span><span class="p">:[]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtypes</span><span class="p">}</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">frm_pdb</span><span class="o">.</span><span class="n">prot</span><span class="p">:</span>
			<span class="k">return</span>
		<span class="n">nan</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
		<span class="k">for</span> <span class="n">m</span><span class="p">,</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">frm_pdb</span><span class="o">.</span><span class="n">get_models_atoms</span><span class="p">():</span>
			<span class="n">templates</span><span class="p">[</span><span class="s1">&#39;PCS&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
				<span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">serial_number</span><span class="p">))</span>
			<span class="n">templates</span><span class="p">[</span><span class="s1">&#39;RDC&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
				<span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">serial_number</span><span class="p">))</span>
			<span class="n">templates</span><span class="p">[</span><span class="s1">&#39;PRE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
				<span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">serial_number</span><span class="p">))</span>

		<span class="k">for</span> <span class="n">dtype</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtypes</span><span class="p">:</span>
			<span class="n">template</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">templates</span><span class="p">[</span><span class="n">dtype</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">structdtype</span><span class="p">[</span><span class="n">dtype</span><span class="p">])</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">templates</span><span class="p">[</span><span class="n">dtype</span><span class="p">]</span> <span class="o">=</span> <span class="n">template</span></div>


<div class="viewcode-block" id="CSAFrame"><a class="viewcode-back" href="../../index.html#paramagpy.gui.CSAFrame">[docs]</a><span class="k">class</span> <span class="nc">CSAFrame</span><span class="p">(</span><span class="n">tk</span><span class="o">.</span><span class="n">LabelFrame</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Frame containing CSA tensor inputs</span>
<span class="sd">	Note this modifies class attribues for protein.CustomAtom dict </span>
<span class="sd">	allowing all instances of CustomAtom to be affected globally</span>
<span class="sd">	&quot;&quot;&quot;</span>
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">):</span>
		<span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;CSA tensor parameters&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span> <span class="c1"># CoordinatesFrame</span>
		<span class="n">Tooltip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tt</span><span class="p">[</span><span class="s1">&#39;csa_frame&#39;</span><span class="p">])</span>

		<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">lbl</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="s1">&#39;xx/ppm&#39;</span><span class="p">,</span><span class="s1">&#39;yy/ppm&#39;</span><span class="p">,</span><span class="s1">&#39;zz/ppm&#39;</span><span class="p">,</span><span class="s1">&#39;</span><span class="se">\u03b2</span><span class="s1">/</span><span class="se">\u00b0</span><span class="s1">&#39;</span><span class="p">]):</span>
			<span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">lbl</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>

		<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">atom</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="s1">&#39;H&#39;</span><span class="p">,</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">]):</span>
			<span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">atom</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
			<span class="n">pas</span><span class="p">,</span> <span class="n">beta</span> <span class="o">=</span> <span class="n">protein</span><span class="o">.</span><span class="n">CustomAtom</span><span class="o">.</span><span class="n">csa_lib</span><span class="p">[</span><span class="n">atom</span><span class="p">]</span>
			<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
				<span class="k">def</span> <span class="nf">wrap</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
					<span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">atom</span><span class="p">,</span> <span class="n">j</span>
					<span class="k">def</span> <span class="nf">parse</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
						<span class="n">protein</span><span class="o">.</span><span class="n">CustomAtom</span><span class="o">.</span><span class="n">csa_lib</span><span class="p">[</span><span class="n">a</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="n">b</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="o">*</span><span class="mf">1E-6</span>
					<span class="k">def</span> <span class="nf">disp</span><span class="p">():</span>
						<span class="k">return</span> <span class="n">protein</span><span class="o">.</span><span class="n">CustomAtom</span><span class="o">.</span><span class="n">csa_lib</span><span class="p">[</span><span class="n">a</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="n">b</span><span class="p">]</span><span class="o">*</span><span class="mf">1E6</span>
					<span class="k">return</span> <span class="n">parse</span><span class="p">,</span> <span class="n">disp</span>

				<span class="n">parse</span><span class="p">,</span> <span class="n">disp</span> <span class="o">=</span> <span class="n">wrap</span><span class="p">(</span><span class="n">atom</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span>
				<span class="n">NumericEntry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parse</span><span class="p">,</span> <span class="n">disp</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>

			<span class="k">def</span> <span class="nf">wrap</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
				<span class="n">a</span> <span class="o">=</span> <span class="n">atom</span>
				<span class="k">def</span> <span class="nf">parse</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
					<span class="n">pas</span><span class="p">,</span> <span class="n">beta</span> <span class="o">=</span> <span class="n">protein</span><span class="o">.</span><span class="n">CustomAtom</span><span class="o">.</span><span class="n">csa_lib</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> 
					<span class="n">protein</span><span class="o">.</span><span class="n">CustomAtom</span><span class="o">.</span><span class="n">csa_lib</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="n">pas</span><span class="p">,</span> <span class="n">value</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">180.</span><span class="p">)</span>
				<span class="k">def</span> <span class="nf">disp</span><span class="p">():</span>
					<span class="k">return</span> <span class="n">protein</span><span class="o">.</span><span class="n">CustomAtom</span><span class="o">.</span><span class="n">csa_lib</span><span class="p">[</span><span class="n">a</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="mf">180.</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
				<span class="k">return</span> <span class="n">parse</span><span class="p">,</span> <span class="n">disp</span>
			<span class="n">parse</span><span class="p">,</span> <span class="n">disp</span> <span class="o">=</span> <span class="n">wrap</span><span class="p">(</span><span class="n">atom</span><span class="p">)</span>
			<span class="n">NumericEntry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parse</span><span class="p">,</span> <span class="n">disp</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span></div>


<div class="viewcode-block" id="CSAPopup"><a class="viewcode-back" href="../../index.html#paramagpy.gui.CSAPopup">[docs]</a><span class="k">class</span> <span class="nc">CSAPopup</span><span class="p">(</span><span class="n">Popup</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;A popup allowing CSA parameters to be set&quot;&quot;&quot;</span>
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">):</span>
		<span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Set CSA parameters&quot;</span>
		<span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>
		<span class="n">CSAFrame</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">pack</span><span class="p">()</span>
		<span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Ok&#39;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">death</span><span class="p">)</span><span class="o">.</span><span class="n">pack</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>

	<span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">death</span><span class="p">()</span></div>


<div class="viewcode-block" id="PDBFrame"><a class="viewcode-back" href="../../index.html#paramagpy.gui.PDBFrame">[docs]</a><span class="k">class</span> <span class="nc">PDBFrame</span><span class="p">(</span><span class="n">tk</span><span class="o">.</span><span class="n">LabelFrame</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Frame for PDB input and model selection</span>
<span class="sd">	prot : the protein object</span>
<span class="sd">	models : the parsed models</span>
<span class="sd">	&quot;&quot;&quot;</span>
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">):</span>
		<span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;PDB &amp; Models&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span> <span class="c1"># CoordinatesFrame</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">num_chars</span> <span class="o">=</span> <span class="mi">30</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">prot</span> <span class="o">=</span> <span class="kc">None</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">models</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([])</span>

		<span class="bp">self</span><span class="o">.</span><span class="n">default_atom_selection</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;H&#39;</span><span class="p">,</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="s1">&#39;O&#39;</span><span class="p">]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">default_resi_selection</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">protein</span><span class="o">.</span><span class="n">standard_aa_names</span><span class="p">)</span>

		<span class="bp">self</span><span class="o">.</span><span class="n">atom_selection</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">default_atom_selection</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">resi_selection</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">default_resi_selection</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">reset_selection</span><span class="p">()</span>

		<span class="n">b</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Read PDB file&#39;</span><span class="p">,</span><span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">read_pdb</span><span class="p">)</span>
		<span class="n">Tooltip</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">tt</span><span class="p">[</span><span class="s1">&#39;read_pdb&#39;</span><span class="p">])</span>
		<span class="n">b</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;EW&#39;</span><span class="p">)</span>

		<span class="bp">self</span><span class="o">.</span><span class="n">lbl_pdb_file</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">num_chars</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">lbl_pdb_file</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

		<span class="c1"># tk.Label(self, text=&quot;Models for pdb:&quot;).grid(row=1, column=0)</span>
		<span class="n">b</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Set Models&#39;</span><span class="p">,</span> 
			<span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parse_models</span><span class="p">)</span>
		<span class="n">Tooltip</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">tt</span><span class="p">[</span><span class="s1">&#39;parse_models&#39;</span><span class="p">])</span>
		<span class="n">b</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;EW&#39;</span><span class="p">)</span>

		<span class="bp">self</span><span class="o">.</span><span class="n">txt_models</span> <span class="o">=</span> <span class="n">CustomTextDefaultEntry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
			<span class="s2">&quot;Choose models. Default: all&quot;</span><span class="p">,</span> <span class="n">returnKey</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parse_models</span><span class="p">)</span>
		<span class="n">Tooltip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">txt_models</span><span class="p">,</span> <span class="n">tt</span><span class="p">[</span><span class="s1">&#39;select_models&#39;</span><span class="p">])</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">txt_models</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

		<span class="n">ttk</span><span class="o">.</span><span class="n">Separator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span>
			<span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">rowspan</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;NS&#39;</span><span class="p">,</span><span class="n">padx</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

		<span class="bp">self</span><span class="o">.</span><span class="n">selction</span> <span class="o">=</span> <span class="kc">None</span>
		<span class="n">b</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Atom Selection&#39;</span><span class="p">,</span><span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">change_selection</span><span class="p">)</span>
		<span class="n">Tooltip</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">tt</span><span class="p">[</span><span class="s1">&#39;selection&#39;</span><span class="p">])</span>
		<span class="n">b</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;EW&#39;</span><span class="p">)</span>

		<span class="bp">self</span><span class="o">.</span><span class="n">frm_csa</span> <span class="o">=</span> <span class="n">CSAFrame</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
		<span class="n">b</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Set CSA&#39;</span><span class="p">,</span><span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">set_csa</span><span class="p">)</span>
		<span class="c1"># Tooltip(b, tt[&#39;selection&#39;])</span>
		<span class="n">b</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;EW&#39;</span><span class="p">)</span>

<div class="viewcode-block" id="PDBFrame.update_views"><a class="viewcode-back" href="../../index.html#paramagpy.gui.PDBFrame.update_views">[docs]</a>	<span class="k">def</span> <span class="nf">update_views</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">strength</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		When the PDB is changed, all experimental data is parsed</span>
<span class="sd">		and all views are updated</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">strength</span><span class="p">)</span></div>

	<span class="k">def</span> <span class="nf">reset_selection</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">atom_selection</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">default_atom_selection</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">resi_selection</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">default_resi_selection</span><span class="p">)</span>

<div class="viewcode-block" id="PDBFrame.read_pdb"><a class="viewcode-back" href="../../index.html#paramagpy.gui.PDBFrame.read_pdb">[docs]</a>	<span class="k">def</span> <span class="nf">read_pdb</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;Open fild dialog to fetch the PDB file path, load and parse&quot;&quot;&quot;</span>
		<span class="n">fileName</span> <span class="o">=</span> <span class="n">filedialog</span><span class="o">.</span><span class="n">askopenfilename</span><span class="p">(</span>
			<span class="n">title</span><span class="o">=</span><span class="s2">&quot;Choose PDB file&quot;</span><span class="p">,</span>
			<span class="n">defaultextension</span><span class="o">=</span><span class="s1">&#39;.pdb&#39;</span><span class="p">,</span>
			<span class="n">filetypes</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;PDB file&#39;</span><span class="p">,</span><span class="s1">&#39;.pdb&#39;</span><span class="p">),(</span><span class="s1">&#39;All files&#39;</span><span class="p">,</span><span class="s1">&#39;.*&#39;</span><span class="p">)])</span>

		<span class="k">if</span> <span class="n">fileName</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">prot</span> <span class="o">=</span> <span class="n">protein</span><span class="o">.</span><span class="n">load_pdb</span><span class="p">(</span><span class="n">fileName</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">lbl_pdb_file</span><span class="o">.</span><span class="n">config</span><span class="p">(</span>
				<span class="n">text</span><span class="o">=</span><span class="n">format_path</span><span class="p">(</span><span class="n">fileName</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_chars</span><span class="p">))</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">parse_models</span><span class="p">()</span></div>

<div class="viewcode-block" id="PDBFrame.parse_models"><a class="viewcode-back" href="../../index.html#paramagpy.gui.PDBFrame.parse_models">[docs]</a>	<span class="k">def</span> <span class="nf">parse_models</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Printer pages type notation to specify the desired models</span>
<span class="sd">		If incorrect notation is entered, the models default to all</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">prot</span><span class="p">:</span>
			<span class="n">prot_models</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="n">i</span><span class="o">.</span><span class="n">id</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">prot</span><span class="p">])</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">models</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([])</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">store</span><span class="p">()</span>
			<span class="k">return</span>

		<span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">txt_models</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
		<span class="k">if</span> <span class="n">s</span><span class="o">==</span><span class="bp">self</span><span class="o">.</span><span class="n">txt_models</span><span class="o">.</span><span class="n">default_text</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">models</span> <span class="o">=</span> <span class="n">prot_models</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">store</span><span class="p">()</span>
			<span class="k">return</span>

		<span class="k">try</span><span class="p">:</span>
			<span class="n">models</span> <span class="o">=</span> <span class="n">unpack_ranges</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
		<span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
			<span class="n">messagebox</span><span class="o">.</span><span class="n">showerror</span><span class="p">(</span><span class="s2">&quot;Error&quot;</span><span class="p">,</span> 
				<span class="s2">&quot;Error parsing models: Default selection set to all&quot;</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">models</span> <span class="o">=</span> <span class="n">prot_models</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">txt_models</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">store</span><span class="p">()</span>
			<span class="k">return</span> <span class="kc">None</span>

		<span class="n">diff</span> <span class="o">=</span> <span class="n">models</span> <span class="o">-</span> <span class="n">prot_models</span>
		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">diff</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
			<span class="n">messagebox</span><span class="o">.</span><span class="n">showwarning</span><span class="p">(</span><span class="s2">&quot;Warning&quot;</span><span class="p">,</span> 
				<span class="s2">&quot;Additional models not found in PDB:</span><span class="se">\n</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">diff</span><span class="p">)))</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">models</span> <span class="o">=</span> <span class="n">models</span> <span class="o">&amp;</span> <span class="n">prot_models</span>
		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
			<span class="n">messagebox</span><span class="o">.</span><span class="n">showwarning</span><span class="p">(</span><span class="s2">&quot;Warning&quot;</span><span class="p">,</span> 
				<span class="s2">&quot;No models selected: Default selection set to all&quot;</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">models</span> <span class="o">=</span> <span class="n">prot_models</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">txt_models</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">store</span><span class="p">()</span></div>

	<span class="k">def</span> <span class="nf">store</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Parsed models:</span><span class="se">\n</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">))</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">update_views</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<div class="viewcode-block" id="PDBFrame.get_atoms"><a class="viewcode-back" href="../../index.html#paramagpy.gui.PDBFrame.get_atoms">[docs]</a>	<span class="k">def</span> <span class="nf">get_atoms</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;Generator for all atoms in the protein&quot;&quot;&quot;</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">prot</span><span class="p">:</span>
			<span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">:</span>
				<span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">prot</span><span class="p">[</span><span class="n">m</span><span class="p">]</span><span class="o">.</span><span class="n">get_atoms</span><span class="p">():</span>
					<span class="k">yield</span> <span class="n">a</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="k">yield</span></div>

	<span class="k">def</span> <span class="nf">get_models_atoms</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">prot</span><span class="p">:</span>
			<span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">:</span>
				<span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">prot</span><span class="p">[</span><span class="n">m</span><span class="p">]</span><span class="o">.</span><span class="n">get_atoms</span><span class="p">():</span>
					<span class="k">yield</span> <span class="n">m</span><span class="p">,</span> <span class="n">a</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="k">yield</span>

	<span class="k">def</span> <span class="nf">change_selection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
		<span class="n">SelectionPopup</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

	<span class="k">def</span> <span class="nf">set_csa</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
		<span class="n">CSAPopup</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>


<div class="viewcode-block" id="CoordinatesFrame"><a class="viewcode-back" href="../../index.html#paramagpy.gui.CoordinatesFrame">[docs]</a><span class="k">class</span> <span class="nc">CoordinatesFrame</span><span class="p">(</span><span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;The frame containing PDB input and CSA info&quot;&quot;&quot;</span>
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">):</span>
		<span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span> <span class="c1"># MainGui</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">frm_pdb</span> <span class="o">=</span> <span class="n">PDBFrame</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">frm_pdb</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">sticky</span><span class="o">=</span><span class="s2">&quot;NESW&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="MainGui"><a class="viewcode-back" href="../../index.html#paramagpy.gui.MainGui">[docs]</a><span class="k">class</span> <span class="nc">MainGui</span><span class="p">(</span><span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	A Frame holding the entire application</span>
<span class="sd">	frm_coords : contains PDB and CSA frames</span>
<span class="sd">	ntb_methods : contains tabs of PCS, RDC and CSA</span>
<span class="sd">	&quot;&quot;&quot;</span>
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">root</span><span class="p">):</span>
		<span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">frm_coords</span> <span class="o">=</span> <span class="n">CoordinatesFrame</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">frm_coords</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">ntb_methods</span> <span class="o">=</span> <span class="n">MethodsNotebook</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">ntb_methods</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;EW&#39;</span><span class="p">)</span>


<div class="viewcode-block" id="MainGui.update"><a class="viewcode-back" href="../../index.html#paramagpy.gui.MainGui.update">[docs]</a>	<span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">strength</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		0 : update all fields, checkboxes and labels</span>
<span class="sd">		1 : update all data views</span>
<span class="sd">		2 : parse experimental data</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">ntb_methods</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">strength</span><span class="p">)</span></div></div>


<span class="n">tooltips_raw</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">read_pdb : Load a PDB file containing protein coordinates for all atoms</span>
<span class="s2">select_models : Select models to be used during fitting. This can be specified using printer-style formatting e.g. &#39;1,3,7&#39; or &#39;1-5&#39; or &#39;1-5,7,9&#39;. Be sure to click the &quot;Parse models&quot; button before continuing.</span>
<span class="s2">parse_models : Selects only the desired models from the PDB file</span>
<span class="s2">selection : Select the atoms and residues to be used during fitting</span>
<span class="s2">csa_frame : Set chemical shift anisotropy tensor parameters for backbone H, N and C nuclei. These are set via the three principle axes and single angle. Default values are taken from G. Cornilescu and A. Bax &quot;Measurement of proton, nitrogen, and carbonyl chemical shielding anisotropies in a protein dissolved in a dilute liquid crystalline phase&quot; J. Am. Chem. Soc. 2000, 122, 10143-10154.</span>
<span class="s2">svd : Single value decomposition is used to analytically solve the tensor anisotropy and orientation over a spherical grid of positions. The best position and tensor are then taken. Note that RACS and RADS cannot be included in this calculation. Note that uncertainties are not taken into account during this calculation.</span>
<span class="s2">nlr : Non-linear regression is used to solve a least-squares algorithm by gradient descent. This is generally used for refinement after an initial guess by the SVD grid search. Note that RACS and RADS can be taken into account by this algorithm.</span>
<span class="s2">ref : Allows fitting of an offset that shifts the entire PCS list by a given value. This may arise due to referencing errors between diamagnetic and paramagnetic peak lists when calculating the PCS. This should always be used when there are many PCS values available.</span>
<span class="s2">pos : Option to disable fitting of the tensor position. Note that the SVD grid search for PCS will collapse to a single point if the position is constrained.</span>
<span class="s2">rad : Radius of the SVD grid search sphere. This is taken with origin about the initial tensor position</span>
<span class="s2">den : The points per Angstrom to be taken in the SVD grid search sphere.</span>
<span class="s2">mod : When selected, fitting is conducted separately for each model specified. The best fitting tensor of a given model is then taken.</span>
<span class="s2">racs : Residual anisotropic chemical shifts are included in the calculation. Fitting with RACS is only achieved with the NLR algorithm.</span>
<span class="s2">rads : Residual anisotropic dipolar shifts are included in the calculation. Fitting with RADS is only achieved with the NLR algorithm.</span>
<span class="s2">taur : The rotational correlation time is included as a parameter for fitting during the calculation.</span>
<span class="s2">taue : The electronic relaxation time is included as a parameter for fitting during the calculation.</span>
<span class="s2">dsa : Dipolar shielding anisotropy (DSA) commonly called the &#39;Curie Spin&#39; relaxation theory is included for the calculation. Note that this method assumes a fast electronic relaxation time (T1e &lt;&lt; TauR). Therefore calculations are independent of the T1e parameter. All calculations for DSA theory will include anisotropy as governed by the DeltaChi tensor of the paramagnetic centre.</span>
<span class="s2">sbm : Solomon-Bloembergen-Morgan (SBM) relaxation theory is included for the calculation. SBM theory uses an effective correlation time that is takes into account the rotational correlation time (TauR) and the electronic relaxation time (T1e), so both must be set when using this method.</span>
<span class="s2">csa : Chemical Shift Anisotropy (CSA) cross-correlated relaxation effects are included for the caluclation. For auto-relaxation of nuclear magnetisation, the CSA may only induce cross-correlated relaxation with the DSA mechanism. Therefore, the DSA relaxation method must be selected to observe CSA cross-correlation effects. The final output value is a sum of the DSA plus the DSAxCSA values, however the relaxation induced by only the CSA is not included. This means only the pure paramagnetic effect is reported.</span>
<span class="s2">dchi : The DeltaChi tensor is included for fitting, allowing the axial and rhombic parameters to be fit during the PRE calculation. Note that the DeltaChi tensor has only a very small effect on the PRE and therefore may lead to unwieldy results if included in the fitting.</span>
<span class="s2">iso : The isotropic Chi tensor is included for fitting during the caluclation. This defines the magnitude of the paramagnetic dipole.</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="n">tt</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">tooltips_raw</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">):</span>
	<span class="k">if</span> <span class="n">line</span><span class="p">:</span>
		<span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
		<span class="n">tt</span><span class="p">[</span><span class="n">key</span><span class="o">.</span><span class="n">strip</span><span class="p">()]</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

<span class="c1"># Run the application</span>
<span class="k">def</span> <span class="nf">run</span><span class="p">():</span>
	<span class="n">settings</span> <span class="o">=</span> <span class="n">platform_settings</span><span class="p">()</span>
	<span class="n">root</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Tk</span><span class="p">()</span>
	<span class="n">root</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;ParaMagPy GUI&#39;</span><span class="p">)</span>

	<span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">sys</span><span class="p">,</span> <span class="s1">&#39;_MEIPASS&#39;</span><span class="p">):</span>
		<span class="n">dataDir</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">_MEIPASS</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="n">dataDir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span>

	<span class="k">try</span><span class="p">:</span>
		<span class="n">icon_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dataDir</span><span class="p">,</span> <span class="s2">&quot;icon.gif&quot;</span><span class="p">)</span>
		<span class="n">icon</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">PhotoImage</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="n">icon_path</span><span class="p">)</span>
		<span class="n">root</span><span class="o">.</span><span class="n">tk</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="s1">&#39;wm&#39;</span><span class="p">,</span> <span class="s1">&#39;iconphoto&#39;</span><span class="p">,</span> <span class="n">root</span><span class="o">.</span><span class="n">_w</span><span class="p">,</span> <span class="n">icon</span><span class="p">)</span>
	<span class="k">except</span> <span class="n">tk</span><span class="o">.</span><span class="n">TclError</span><span class="p">:</span>
		<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Note: icon not found&quot;</span><span class="p">)</span>

	<span class="n">main</span> <span class="o">=</span> <span class="n">MainGui</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
	<span class="n">main</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">expand</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
	<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="n">root</span><span class="o">.</span><span class="n">mainloop</span><span class="p">()</span>
			<span class="k">break</span>
		<span class="k">except</span> <span class="ne">UnicodeDecodeError</span><span class="p">:</span>
			<span class="k">pass</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
	<span class="n">run</span><span class="p">()</span>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">paramagpy 0.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Module code</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2018, Henry Orton.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.1.
    </div>
  </body>
</html>